!(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("inferno-create-element"),require("inferno-component"),require("inferno"),require("path-to-regexp")):"function"==typeof define&&define.amd?define(["exports","inferno-create-element","inferno-component","inferno","path-to-regexp"],e):e((t.Inferno=t.Inferno||{},t.Inferno.Router={}),t.Inferno.createElement,t.Inferno.Component,t.Inferno,t.pathToRegexp)})(this,(function(t,e,r,o,n){"use strict";function i(t){return A(t)?t:t?[t]:t}function p(t){return"string"==typeof t}function c(t,e){var r={};if(t)for(var o in t)r[o]=t[o];if(e)for(var n in e)r[n]=e[n];return r}function u(t){return"string"!=typeof t?t:decodeURIComponent(t)}function a(t){return!t||!(A(t)?t:Object.keys(t)).length}function s(t){var e=[];return R(t,e),e}function l(t){return p(t)?t:t.pathname+t.search}function f(t){if(""===t)return{};for(var e=Object.create(null),r=t.split("&"),o=0,n=r.length;o<n;o++){var i=r[o].split("=").map(v).map(decodeURIComponent),p=i[0],c=i[1];e[p]?(e[p]=A(e[p])?e[p]:[e[p]],e[p].push(c)):e[p]=c}return e}function h(t,e){return 0===t.indexOf(e)?t.substr(e.length):t}function d(t,e){var r={};for(var o in t)e.indexOf(o)<0&&(r[o]=t[o]);return r}function y(t,e){var r=t.props||B,o=e.props||B;return x(o.path)-x(r.path)||(o.path&&r.path?o.path.length-r.path.length:0)}function v(t,e){return decodeURIComponent(0|e?t:t.replace("[]",""))}function m(t){return t.replace(/(^\/+|\/+$)/g,"")}function x(t){return void 0===t&&(t=""),(m(t).match(/\/+/g)||"").length}function R(t,e){for(var r=0,o=t.length;r<o;r++){var n=t[r];A(n)?R(n,e):e.push(n)}}function g(t){if(t.indexRoute&&!t.childRoutes)return e(L,t);var r={};for(var o in t)r[o]=t[o];if(r.children=[],r.indexRoute&&(r.children.push(N(r.indexRoute)),delete r.indexRoute),r.childRoutes){var n=A(r.childRoutes)?r.childRoutes:[r.childRoutes];(i=r.children).push.apply(i,W(n)),delete r.childRoutes}return 1===r.children.length&&(r.children=r.children[0]),(A(r.children)&&0===r.children.length||!A(r.children)&&0===Object.keys(r.children).length)&&delete r.children,e(L,r);var i}function C(t){var e=[],r=function(t){t&&(t.props&&t.props.children&&r(t.props.children),"Route"===t.type.name&&t.props.asyncBefore&&e.push(t.type.prototype.doAsyncBefore.call(t,t.props.params)))};return r(t.matched),Promise.all(e).then((function(){return Promise.resolve(!0)}))}function _(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&(r[o[n]]=t[o[n]]);return r}function b(t,e,r){return o.createVNode(2,"a",t,e,r)}function O(t,e){var r,o=e.router,n=t.activeClassName,i=t.activeStyle,p=t.className,u=t.onClick,a=t.children,s=t.to,l=_(t,["activeClassName","activeStyle","className","onClick","children","to"]);return p&&(r=p),o?(l.href=T?o.createHref({pathname:s}):o.location.baseUrl?o.location.baseUrl+s:s,o.location.pathname===s&&(n&&(r=(p?p+" ":"")+n),i&&(l.style=c(t.style,i))),l.onclick=function(t){0!==t.button||t.ctrlKey||t.altKey||t.metaKey||t.shiftKey||(t.preventDefault(),"function"==typeof u&&u(t),o.push(s,t.target.textContent))},b(r,a,l)):(l.href=s,l.onClick=u,b(r,a,l))}function k(t){return t.to="/",o.createVNode(8,O,null,null,t)}function I(t,e){var r=l(e);return j(i(t),encodeURI(r),"/")}function j(t,e,r,o){void 0===e&&(e="/"),void 0===r&&(r="/"),void 0===o&&(o=!1);var n=A(t)?s(t):i(t),p=e.split("?"),u=p[0];void 0===u&&(u="/");var l=p[1];void 0===l&&(l="");var d=f(l);n.sort(y);for(var v=0,m=n.length;v<m;v++){var x=n[v],R=x.props||B,g=r+h(R.from||R.path||"/",r).replace(/\/\//g,"/"),C=U(a(R.children),g,u);if(C){var _=R.children;if(R.from&&(o=R.to),_){var b=j(_,e,g,o);if(b){if(b.redirect)return{location:g,redirect:b.redirect};var O=(_=b.matched).props.params;for(var k in O)d[k]=O[k]}else _=null}return{location:g,matched:P.cloneVNode(x,{children:_,params:c(d,C.params)}),redirect:o}}}}function U(t,e,r){var o=e+"|"+t,n=V.get(o);if(void 0===n){var i=[];n={pattern:M(e,i,{end:t}),keys:i},V.set(o,n)}var p=n.pattern.exec(r);if(!p)return null;for(var c=p[0],a=Object.create(null),s=1,l=p.length;s<l;s+=1)a[n.keys[s-1].name]=u(p[s]);return{params:a,path:""===c?"/":c}}function w(t){if(!t)throw new TypeError('Inferno: Error "inferno-router" requires a history prop passed');return{createHref:t.createHref,listen:t.listen,push:t.push,replace:t.replace,isActive:function(t){return U(!0,t,this.url)},get location(){return"blank"!==t.location.pathname?t.location:{pathname:"/",search:""}},get url(){return this.location.pathname+this.location.search}}}e=e&&e.hasOwnProperty("default")?e.default:e,r=r&&r.hasOwnProperty("default")?r.default:r;var P="default"in o?o.default:o;n=n&&n.hasOwnProperty("default")?n.default:n;var T=!("undefined"==typeof window||!window.document),A=Array.isArray,B={},E=Promise.resolve(),L=(function(t){function r(e,r){var o=this;t.call(this,e,r),this._onComponentResolved=function(t,e){o.setState({asyncComponent:e})},this.state={asyncComponent:null}}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.componentWillMount=function(){var t=this,e=this.props.onEnter,r=this.context.router;e&&E.then((function(){e({props:t.props,router:r})}));var o=this.props.getComponent;o&&E.then((function(){o({props:t.props,router:r},t._onComponentResolved)}))},r.prototype.doAsyncBefore=function(t){return this.props.asyncBefore?this.props.asyncBefore(t):Promise.resolve()},r.prototype.onLeave=function(t){void 0===t&&(t=!1);var e=this.props.onLeave,r=this.context.router;e&&t&&e({props:this.props,router:r})},r.prototype.onEnter=function(t){var e=t.onEnter,r=this.context.router;this.props.path!==t.path&&e&&e({props:t,router:r})},r.prototype.getComponent=function(t){var e=t.getComponent,r=this.context.router;this.props.path!==t.path&&e&&e({props:t,router:r},this._onComponentResolved)},r.prototype.componentWillUnmount=function(){this.onLeave(!0)},r.prototype.componentWillReceiveProps=function(t){this.getComponent(t),this.onEnter(t),this.onLeave(this.props.path!==t.path)},r.prototype.render=function(t){var r=t.component,o=t.children,n=d(t,["component","children","path","getComponent"]),i=this.state.asyncComponent,p=r||i;return p?e(p,n,o):A(o)?null:o},r})(r),N=function(t){return e(L,t)},S=function(t){return g(t)},W=function(t){return t.map(S)},q=function(t){return t.map(g)},K=(function(t){function e(e,r){t.call(this,e,r),e.path="/"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e})(L),M=(function(t,e){return e={exports:{}},t(e,e.exports),e.exports})((function(t){t.exports=n,t.exports.parse=n.parse,t.exports.compile=n.compile,t.exports.tokensToFunction=n.tokensToFunction,t.exports.tokensToRegExp=n.tokensToRegExp,t.exports.default=t.exports})),V=new Map,H=(function(t){function e(e,r){t.call(this,e,r),e.to||(e.to="/")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e})(L),F=(function(t){function e(e,r){t.call(this,e,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getChildContext=function(){return{router:this.props.router||{location:{baseUrl:this.props.baseUrl,pathname:this.props.location}}}},e.prototype.render=function(t){return t.matched},e})(r),D=(function(t){function e(e,r){t.call(this,e,r),this.router=w(e.history),this.state={url:e.url||this.router.url}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.componentWillMount=function(){var t=this;this.router&&(this.unlisten=this.router.listen((function(){if("function"==typeof t.props.asyncBefore){var e=t;t.props.asyncBefore(t.router.url).then((function(){e.routeTo(e.router.url)}))}else t.routeTo(t.router.url)})))},e.prototype.componentWillReceiveProps=function(t){var e=this;this.setState({url:t.url},this.props.onUpdate?function(){return e.props.onUpdate()}:void 0)},e.prototype.componentWillUnmount=function(){this.unlisten&&this.unlisten()},e.prototype.routeTo=function(t){var e=this;this.setState({url:t},this.props.onUpdate?function(){return e.props.onUpdate()}:void 0)},e.prototype.render=function(t){var e=this,r=I(t.children,this.state.url);return r.redirect?(setTimeout((function(){e.router.replace(r.redirect)}),0),null):o.createVNode(4,F,null,null,{location:this.state.url,matched:r.matched,router:this.router})},e})(r),$={IndexLink:k,IndexRedirect:H,IndexRoute:K,Link:O,Redirect:H,Route:L,Router:D,RouterContext:F,createRoutes:q,doAllAsyncBefore:C,match:I};t.IndexLink=k,t.IndexRedirect=H,t.IndexRoute=K,t.Link=O,t.Redirect=H,t.Route=L,t.Router=D,t.RouterContext=F,t.createRoutes=q,t.doAllAsyncBefore=C,t.match=I,t.default=$,Object.defineProperty(t,"__esModule",{value:!0})}));
