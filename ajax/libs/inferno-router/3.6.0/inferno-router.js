!(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("inferno-create-element"),require("inferno-component"),require("inferno"),require("path-to-regexp")):"function"==typeof define&&define.amd?define(["exports","inferno-create-element","inferno-component","inferno","path-to-regexp"],t):t((e.Inferno=e.Inferno||{},e.Inferno.Router=e.Inferno.Router||{}),e.Inferno.createElement,e.Inferno.Component,e.Inferno)})(this,(function(e,t,n,r){"use strict";function o(e){return H(e)?e:e?[e]:e}function i(e){return"string"==typeof e}function p(e){console.warn(e)}function c(e,t){var n={};if(e)for(var r in e)n[r]=e[r];if(t)for(var o in t)n[o]=t[o];return n}function u(e){return"string"!=typeof e?e:decodeURIComponent(e)}function a(e){return!e||!(H(e)?e:Object.keys(e)).length}function s(e){var t=[];return x(e,t),t}function l(e){return i(e)?e:e.pathname+e.search}function f(e){if(""===e)return{};for(var t=Object.create(null),n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=").map(v).map(decodeURIComponent),p=i[0],c=i[1];t[p]?(t[p]=H(t[p])?t[p]:[t[p]],t[p].push(c)):t[p]=c}return t}function h(e,t){return 0===e.indexOf(t)?e.substr(t.length):e}function d(e,t){var n={};for(var r in e)t.indexOf(r)<0&&(n[r]=e[r]);return n}function m(e,t){var n=e.props||J,r=t.props||J;return g(r.path)-g(n.path)||(r.path&&n.path?r.path.length-n.path.length:0)}function v(e,t){return decodeURIComponent(0|t?e:e.replace("[]",""))}function y(e){return e.replace(/(^\/+|\/+$)/g,"")}function g(e){return void 0===e&&(e=""),(y(e).match(/\/+/g)||"").length}function x(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];H(o)?x(o,t):t.push(o)}}function R(e){if(e.indexRoute&&!e.childRoutes)return t(D,e);var n={};for(var r in e)n[r]=e[r];if(n.children=[],n.indexRoute&&(n.children.push(B(n.indexRoute)),delete n.indexRoute),n.childRoutes){var o=H(n.childRoutes)?n.childRoutes:[n.childRoutes];(i=n.children).push.apply(i,Q(o)),delete n.childRoutes}return 1===n.children.length&&(n.children=n.children[0]),(H(n.children)&&0===n.children.length||!H(n.children)&&0===Object.keys(n.children).length)&&delete n.children,t(D,n);var i}function b(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]]);return n}function C(e,t,n){return r.createVNode(2,"a",e,t,n)}function w(e,t){var n,r=t.router,o=e.activeClassName,i=e.activeStyle,u=e.className,a=e.onClick,s=e.children,l=e.to,f=b(e,["activeClassName","activeStyle","className","onClick","children","to"]);return u&&(n=u),r?(f.href=V?r.createHref({pathname:l}):r.location.baseUrl?r.location.baseUrl+l:l,r.location.pathname===l&&(o&&(n=(u?u+" ":"")+o),i&&(f.style=c(e.style,i))),f.onclick=function(e){0!==e.button||e.ctrlKey||e.altKey||e.metaKey||e.shiftKey||(e.preventDefault(),"function"==typeof a&&a(e),r.push(l,e.target.textContent))},C(n,s,f)):(p("<Link/> component used outside of <Router/>. Fallback to <a> tag."),f.href=l,f.onClick=a,C(n,s,f))}function E(e){return e.to="/",r.createVNode(8,w,null,null,e)}function k(e,t){for(var n,r=[],o=0,i=0,p="",c=t&&t.delimiter||"/";null!=(n=ie.exec(e));){var u=n[0],a=n[1],s=n.index;if(p+=e.slice(i,s),i=s+u.length,a)p+=a[1];else{var l=e[i],f=n[2],h=n[3],d=n[4],m=n[5],v=n[6],y=n[7];p&&(r.push(p),p="");var g=null!=f&&null!=l&&l!==f,x="+"===v||"*"===v,R="?"===v||"*"===v,b=n[2]||c,C=d||m;r.push({name:h||o++,prefix:f||"",delimiter:b,optional:R,repeat:x,partial:g,asterisk:!!y,pattern:C?U(C):y?".*":"[^"+I(b)+"]+?"})}}return i<e.length&&(p+=e.substr(i)),p&&r.push(p),r}function _(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function O(e){return encodeURI(e).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function j(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(t[n]=new RegExp("^(?:"+e[n].pattern+")$"));return function(n,r){for(var o="",i=n||{},p=(r||{}).pretty?_:encodeURIComponent,c=0;c<e.length;c++){var u=e[c];if("string"!=typeof u){var a,s=i[u.name];if(null==s){if(u.optional){u.partial&&(o+=u.prefix);continue}throw new TypeError('Expected "'+u.name+'" to be defined')}if(Z(s)){if(!u.repeat)throw new TypeError('Expected "'+u.name+'" to not repeat, but received `'+JSON.stringify(s)+"`");if(0===s.length){if(u.optional)continue;throw new TypeError('Expected "'+u.name+'" to not be empty')}for(var l=0;l<s.length;l++){if(a=p(s[l]),!t[c].test(a))throw new TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'", but received `'+JSON.stringify(a)+"`");o+=(0===l?u.prefix:u.delimiter)+a}}else{if(a=u.asterisk?O(s):p(s),!t[c].test(a))throw new TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but received "'+a+'"');o+=u.prefix+a}}else o+=u}return o}}function I(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function U(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function T(e,t){return e.keys=t,e}function S(e){return e.sensitive?"":"i"}function N(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return T(e,t)}function A(e,t,n){for(var r=[],o=0;o<e.length;o++)r.push(P(e[o],t,n).source);return T(new RegExp("(?:"+r.join("|")+")",S(n)),t)}function L(e,t,n){return $(k(e,n),t,n)}function $(e,t,n){Z(t)||(n=t||n,t=[]);for(var r=(n=n||{}).strict,o=!1!==n.end,i="",p=0;p<e.length;p++){var c=e[p];if("string"==typeof c)i+=I(c);else{var u=I(c.prefix),a="(?:"+c.pattern+")";t.push(c),c.repeat&&(a+="(?:"+u+a+")*"),i+=a=c.optional?c.partial?u+"("+a+")?":"(?:"+u+"("+a+"))?":u+"("+a+")"}}var s=I(n.delimiter||"/"),l=i.slice(-s.length)===s;return r||(i=(l?i.slice(0,-s.length):i)+"(?:"+s+"(?=$))?"),i+=o?"$":r&&l?"":"(?="+s+"|$)",T(new RegExp("^"+i,S(n)),t)}function P(e,t,n){return Z(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?N(e,t):Z(e)?A(e,t,n):L(e,t,n)}function q(e,t){var n=l(t);return W(o(e),encodeURI(n),"/")}function W(e,t,n,r){void 0===t&&(t="/"),void 0===n&&(n="/"),void 0===r&&(r=!1);var i=H(e)?s(e):o(e),p=t.split("?"),u=p[0];void 0===u&&(u="/");var l=p[1];void 0===l&&(l="");var d=f(l);i.sort(m);for(var v=0,y=i.length;v<y;v++){var g=i[v],x=g.props||J,R=n+h(x.from||x.path||"/",n).replace(/\/\//g,"/"),b=F(a(x.children),R,u);if(b){var C=x.children;if(x.from&&(r=x.to),C){var w=W(C,t,R,r);if(w){if(w.redirect)return{location:R,redirect:w.redirect};var E=(C=w.matched).props.params;for(var k in E)d[k]=E[k]}else C=null}return{location:R,matched:M.cloneVNode(g,{children:C,params:c(d,b.params)}),redirect:r}}}}function F(e,t,n){var r=t+"|"+e,o=ae.get(r);if(void 0===o){var i=[];o={pattern:ue(t,i,{end:e}),keys:i},ae.set(r,o)}var p=o.pattern.exec(n);if(!p)return null;for(var c=p[0],a=Object.create(null),s=1,l=p.length;s<l;s+=1)a[o.keys[s-1].name]=u(p[s]);return{params:a,path:""===c?"/":c}}function K(e){if(!e)throw new TypeError('Inferno: Error "inferno-router" requires a history prop passed');return{createHref:e.createHref,listen:e.listen,push:e.push,replace:e.replace,isActive:function(e){return F(!0,e,this.url)},get location(){return"blank"!==e.location.pathname?e.location:{pathname:"/",search:""}},get url(){return this.location.pathname+this.location.search}}}t=t&&"default"in t?t.default:t,n=n&&"default"in n?n.default:n;var M="default"in r?r.default:r,V=!("undefined"==typeof window||!window.document),H=Array.isArray,J={},z=Promise.resolve(),D=(function(e){function n(t,n){var r=this;e.call(this,t,n),this._onComponentResolved=function(e,t){r.setState({asyncComponent:t})},this.state={asyncComponent:null}}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.componentWillMount=function(){var e=this,t=this.props.onEnter,n=this.context.router;t&&z.then((function(){t({props:e.props,router:n})}));var r=this.props.getComponent;r&&z.then((function(){r({props:e.props,router:n},e._onComponentResolved)}))},n.prototype.onLeave=function(e){void 0===e&&(e=!1);var t=this.props.onLeave,n=this.context.router;t&&e&&t({props:this.props,router:n})},n.prototype.onEnter=function(e){var t=e.onEnter,n=this.context.router;this.props.path!==e.path&&t&&t({props:e,router:n})},n.prototype.getComponent=function(e){var t=e.getComponent,n=this.context.router;this.props.path!==e.path&&t&&t({props:e,router:n},this._onComponentResolved)},n.prototype.componentWillUnmount=function(){this.onLeave(!0)},n.prototype.componentWillReceiveProps=function(e){this.getComponent(e),this.onEnter(e),this.onLeave(this.props.path!==e.path)},n.prototype.render=function(e){var n=e.component,r=e.children,o=d(e,["component","children","path","getComponent"]),i=this.state.asyncComponent,p=n||i;return p?t(p,o,r):H(r)?null:r},n})(n),B=function(e){return t(D,e)},G=function(e){return R(e)},Q=function(e){return e.map(G)},X=function(e){return e.map(R)},Y=(function(e){function t(t,n){e.call(this,t,n),t.path="/"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t})(D),Z=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},ee=P,te=k,ne=function(e,t){return j(k(e,t))},re=j,oe=$,ie=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");ee.parse=te,ee.compile=ne,ee.tokensToFunction=re,ee.tokensToRegExp=oe;var pe=Object.freeze({default:ee,__moduleExports:ee,parse:te,compile:ne,tokensToFunction:re,tokensToRegExp:oe}),ce=pe&&ee||pe,ue=(function(e,t){return t={exports:{}},e(t,t.exports),t.exports})((function(e){e.exports=ce,e.exports.parse=ce.parse,e.exports.compile=ce.compile,e.exports.tokensToFunction=ce.tokensToFunction,e.exports.tokensToRegExp=ce.tokensToRegExp,e.exports.default=e.exports})),ae=new Map,se=(function(e){function t(t,n){e.call(this,t,n),t.to||(t.to="/")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t})(D),le=(function(e){function t(t,n){if(e.call(this,t,n),!t.location||!t.matched)throw new TypeError('"inferno-router" requires a "location" and "matched" props passed')}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getChildContext=function(){return{router:this.props.router||{location:{baseUrl:this.props.baseUrl,pathname:this.props.location}}}},t.prototype.render=function(e){return e.matched},t})(n),fe=(function(e){function t(t,n){e.call(this,t,n),this.router=K(t.history),this.state={url:t.url||this.router.url}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentWillMount=function(){var e=this;this.router&&(this.unlisten=this.router.listen((function(){e.routeTo(e.router.url)})))},t.prototype.componentWillReceiveProps=function(e){var t=this;this.setState({url:e.url},this.props.onUpdate?function(){return t.props.onUpdate()}:void 0)},t.prototype.componentWillUnmount=function(){this.unlisten&&this.unlisten()},t.prototype.routeTo=function(e){var t=this;this.setState({url:e},this.props.onUpdate?function(){return t.props.onUpdate()}:void 0)},t.prototype.render=function(e){var t=this,n=q(e.children,this.state.url);return n.redirect?(setTimeout((function(){t.router.replace(n.redirect)}),0),null):r.createVNode(4,le,null,null,{location:this.state.url,matched:n.matched,router:this.router})},t})(n),he={IndexLink:E,IndexRedirect:se,IndexRoute:Y,Link:w,Redirect:se,Route:D,Router:fe,RouterContext:le,createRoutes:X,match:q};e.IndexLink=E,e.IndexRedirect=se,e.IndexRoute=Y,e.Link=w,e.Redirect=se,e.Route=D,e.Router=fe,e.RouterContext=le,e.createRoutes=X,e.match=q,e.default=he,Object.defineProperty(e,"__esModule",{value:!0})}));
