!(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("inferno-create-element"),require("inferno-component"),require("inferno"),require("path-to-regexp")):"function"==typeof define&&define.amd?define(["exports","inferno-create-element","inferno-component","inferno","path-to-regexp"],e):e((t.Inferno=t.Inferno||{},t.Inferno.Router={}),t.Inferno.createElement,t.Inferno.Component,t.Inferno,t.pathToRegexp)})(this,(function(t,e,r,o,n){"use strict";function i(t){return B(t)?t:t?[t]:t}function p(t){return"string"==typeof t}function u(t,e){var r={};if(t)for(var o in t)r[o]=t[o];if(e)for(var n in e)r[n]=e[n];return r}function c(){this.listeners=[]}function s(t){return"string"!=typeof t?t:decodeURIComponent(t)}function a(t){return!t||!(B(t)?t:Object.keys(t)).length}function l(t){var e=[];return g(t,e),e}function f(t){return p(t)?t:t.pathname+t.search}function h(t){if(""===t)return{};for(var e=Object.create(null),r=t.split("&"),o=0,n=r.length;o<n;o++){var i=r[o].split("=").map(m).map(decodeURIComponent),p=i[0],u=i[1];e[p]?(e[p]=B(e[p])?e[p]:[e[p]],e[p].push(u)):e[p]=u}return e}function d(t,e){return 0===t.indexOf(e)?t.substr(e.length):t}function y(t,e){var r={};for(var o in t)e.indexOf(o)<0&&(r[o]=t[o]);return r}function v(t,e){var r=t.props||E,o=e.props||E;return R(o.path)-R(r.path)||(o.path&&r.path?o.path.length-r.path.length:0)}function m(t,e){return decodeURIComponent(0|e?t:t.replace("[]",""))}function x(t){return t.replace(/(^\/+|\/+$)/g,"")}function R(t){return void 0===t&&(t=""),(x(t).match(/\/+/g)||"").length}function g(t,e){for(var r=0,o=t.length;r<o;r++){var n=t[r];B(n)?g(n,e):e.push(n)}}function C(t){if(t.indexRoute&&!t.childRoutes)return e(N,t);var r={};for(var o in t)r[o]=t[o];if(r.children=[],r.indexRoute&&(r.children.push(S(r.indexRoute)),delete r.indexRoute),r.childRoutes){var n=B(r.childRoutes)?r.childRoutes:[r.childRoutes];(i=r.children).push.apply(i,q(n)),delete r.childRoutes}return 1===r.children.length&&(r.children=r.children[0]),(B(r.children)&&0===r.children.length||!B(r.children)&&0===Object.keys(r.children).length)&&delete r.children,e(N,r);var i}function _(t){var e=[],r=function(t){t&&(t.props&&t.props.children&&r(t.props.children),"Route"===t.type.name&&t.props.asyncBefore&&e.push(t.type.prototype.doAsyncBefore.call(t,t.props.params)))};return r(t.matched),Promise.all(e).then((function(){return Promise.resolve(!0)}))}function b(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&(r[o[n]]=t[o[n]]);return r}function O(t,e,r){return o.createVNode(2,"a",t,e,r)}function k(t,e){var r,o=e.router,n=t.activeClassName,i=t.activeStyle,p=t.className,c=t.onClick,s=t.children,a=t.to,l=b(t,["activeClassName","activeStyle","className","onClick","children","to"]);return p&&(r=p),o?(l.href=A?o.createHref({pathname:a}):o.location.baseUrl?o.location.baseUrl+a:a,o.location.pathname===a&&(n&&(r=(p?p+" ":"")+n),i&&(l.style=u(t.style,i))),l.onclick=function(t){0!==t.button||t.ctrlKey||t.altKey||t.metaKey||t.shiftKey||(t.preventDefault(),"function"==typeof c&&c(t),o.push(a,t.target.textContent))},O(r,s,l)):(l.href=a,l.onClick=c,O(r,s,l))}function I(t){return t.to="/",o.createVNode(8,k,null,null,t)}function j(t,e){var r=f(e);return U(i(t),encodeURI(r),"/")}function U(t,e,r,o){void 0===e&&(e="/"),void 0===r&&(r="/"),void 0===o&&(o=!1);var n=B(t)?l(t):i(t),p=e.split("?"),c=p[0];void 0===c&&(c="/");var s=p[1];void 0===s&&(s="");var f=h(s);n.sort(v);for(var y=0,m=n.length;y<m;y++){var x=n[y],R=x.props||E,g=r+d(R.from||R.path||"/",r).replace(/\/\//g,"/"),C=w(a(R.children),g,c);if(C){var _=R.children;if(R.from&&(o=R.to),_){var b=U(_,e,g,o);if(b){if(b.redirect)return{location:g,redirect:b.redirect};var O=(_=b.matched).props.params;for(var k in O)f[k]=O[k]}else _=null}return{location:g,matched:T.cloneVNode(x,{children:_,params:u(f,C.params)}),redirect:o}}}}function w(t,e,r){var o=e+"|"+t,n=H.get(o);if(void 0===n){var i=[];n={pattern:V(e,i,{end:t}),keys:i},H.set(o,n)}var p=n.pattern.exec(r);if(!p)return null;for(var u=p[0],c=Object.create(null),a=1,l=p.length;a<l;a+=1)c[n.keys[a-1].name]=s(p[a]);return{params:c,path:""===u?"/":u}}function P(t){if(!t)throw new TypeError('Inferno: Error "inferno-router" requires a history prop passed');return{createHref:t.createHref,listen:t.listen,push:t.push,replace:t.replace,isActive:function(t){return w(!0,t,this.url)},get location(){return"blank"!==t.location.pathname?t.location:{pathname:"/",search:""}},get url(){return this.location.pathname+this.location.search}}}e=e&&e.hasOwnProperty("default")?e.default:e,r=r&&r.hasOwnProperty("default")?r.default:r;var T="default"in o?o.default:o;n=n&&n.hasOwnProperty("default")?n.default:n;var A=!("undefined"==typeof window||!window.document),B=Array.isArray;c.prototype.addListener=function(t){this.listeners.push(t)},c.prototype.trigger=function(){for(var t,e=this.listeners;t=e.shift();)t()};var E={},L=Promise.resolve(),N=(function(t){function r(e,r){var o=this;t.call(this,e,r),this._onComponentResolved=function(t,e){o.setState({asyncComponent:e})},this.state={asyncComponent:null}}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.componentWillMount=function(){var t=this,e=this.props.onEnter,r=this.context.router;e&&L.then((function(){e({props:t.props,router:r})}));var o=this.props.getComponent;o&&L.then((function(){o({props:t.props,router:r},t._onComponentResolved)}))},r.prototype.doAsyncBefore=function(t){return this.props.asyncBefore?this.props.asyncBefore(t):Promise.resolve()},r.prototype.onLeave=function(t){void 0===t&&(t=!1);var e=this.props.onLeave,r=this.context.router;e&&t&&e({props:this.props,router:r})},r.prototype.onEnter=function(t){var e=t.onEnter,r=this.context.router;this.props.path!==t.path&&e&&e({props:t,router:r})},r.prototype.getComponent=function(t){var e=t.getComponent,r=this.context.router;this.props.path!==t.path&&e&&e({props:t,router:r},this._onComponentResolved)},r.prototype.componentWillUnmount=function(){this.onLeave(!0)},r.prototype.componentWillReceiveProps=function(t){this.getComponent(t),this.onEnter(t),this.onLeave(this.props.path!==t.path)},r.prototype.render=function(t){var r=t.component,o=t.children,n=y(t,["component","children","path","getComponent"]),i=this.state.asyncComponent,p=r||i;return p?e(p,n,o):B(o)?null:o},r})(r),S=function(t){return e(N,t)},W=function(t){return C(t)},q=function(t){return t.map(W)},K=function(t){return t.map(C)},M=(function(t){function e(e,r){t.call(this,e,r),e.path="/"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e})(N),V=(function(t,e){return e={exports:{}},t(e,e.exports),e.exports})((function(t){t.exports=n,t.exports.parse=n.parse,t.exports.compile=n.compile,t.exports.tokensToFunction=n.tokensToFunction,t.exports.tokensToRegExp=n.tokensToRegExp,t.exports.default=t.exports})),H=new Map,F=(function(t){function e(e,r){t.call(this,e,r),e.to||(e.to="/")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e})(N),D=(function(t){function e(e,r){t.call(this,e,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getChildContext=function(){return{router:this.props.router||{location:{baseUrl:this.props.baseUrl,pathname:this.props.location}}}},e.prototype.render=function(t){return t.matched},e})(r),$=(function(t){function e(e,r){t.call(this,e,r),this.router=P(e.history),this.state={url:e.url||this.router.url}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.componentWillMount=function(){var t=this;this.router&&(this.unlisten=this.router.listen((function(){if("function"==typeof t.props.asyncBefore){var e=t;t.props.asyncBefore(t.router.url).then((function(){e.routeTo(e.router.url)}))}else t.routeTo(t.router.url)})))},e.prototype.componentWillReceiveProps=function(t){var e=this;this.setState({url:t.url},this.props.onUpdate?function(){return e.props.onUpdate()}:void 0)},e.prototype.componentWillUnmount=function(){this.unlisten&&this.unlisten()},e.prototype.routeTo=function(t){var e=this;this.setState({url:t},this.props.onUpdate?function(){return e.props.onUpdate()}:void 0)},e.prototype.render=function(t){var e=this,r=j(t.children,this.state.url);return r.redirect?(setTimeout((function(){e.router.replace(r.redirect)}),0),null):o.createVNode(4,D,null,null,{location:this.state.url,matched:r.matched,router:this.router})},e})(r),z={IndexLink:I,IndexRedirect:F,IndexRoute:M,Link:k,Redirect:F,Route:N,Router:$,RouterContext:D,createRoutes:K,doAllAsyncBefore:_,match:j};t.IndexLink=I,t.IndexRedirect=F,t.IndexRoute=M,t.Link=k,t.Redirect=F,t.Route=N,t.Router=$,t.RouterContext=D,t.createRoutes=K,t.doAllAsyncBefore=_,t.match=j,t.default=z,Object.defineProperty(t,"__esModule",{value:!0})}));
