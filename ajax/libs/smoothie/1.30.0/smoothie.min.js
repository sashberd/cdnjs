!function(t){function e(t){this.options=a.extend({},e.defaultOptions,t),this.clear()}function i(t){this.options=a.extend({},i.defaultChartOptions,t),this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0,this.lastRenderTimeMillis=0}var a={extend:function(){arguments[0]=arguments[0]||{};for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[t].hasOwnProperty(e)&&("object"==typeof arguments[t][e]?arguments[t][e]instanceof Array?arguments[0][e]=arguments[t][e]:arguments[0][e]=a.extend(arguments[0][e],arguments[t][e]):arguments[0][e]=arguments[t][e]);return arguments[0]}};e.defaultOptions={resetBoundsInterval:3e3,resetBounds:!0},e.prototype.clear=function(){this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN},e.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1],this.minValue=this.data[0][1];for(var t=1;t<this.data.length;t++){var e=this.data[t][1];e>this.maxValue&&(this.maxValue=e),e<this.minValue&&(this.minValue=e)}}else this.maxValue=Number.NaN,this.minValue=Number.NaN},e.prototype.append=function(t,e,i){for(var a=this.data.length-1;a>=0&&this.data[a][0]>t;)a--;-1===a?this.data.splice(0,0,[t,e]):this.data.length>0&&this.data[a][0]===t?i?(this.data[a][1]+=e,e=this.data[a][1]):this.data[a][1]=e:a<this.data.length-1?this.data.splice(a+1,0,[t,e]):this.data.push([t,e]),this.maxValue=isNaN(this.maxValue)?e:Math.max(this.maxValue,e),this.minValue=isNaN(this.minValue)?e:Math.min(this.minValue,e)},e.prototype.dropOldData=function(t,e){for(var i=0;this.data.length-i>=e&&this.data[i+1][0]<t;)i++;0!==i&&this.data.splice(0,i)},i.defaultChartOptions={millisPerPixel:20,enableDpiScaling:!0,yMinFormatter:function(t,e){return parseFloat(t).toFixed(e)},yMaxFormatter:function(t,e){return parseFloat(t).toFixed(e)},maxValueScale:1,minValueScale:1,interpolation:"bezier",scaleSmoothing:.125,maxDataSetLength:2,scrollBackwards:!1,grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:1,sharpLines:!1,millisPerLine:1e3,verticalSections:2,borderVisible:!0},labels:{fillStyle:"#ffffff",disabled:!1,fontSize:10,fontFamily:"monospace",precision:2},horizontalLines:[],responsive:!1},i.AnimateCompatibility={requestAnimationFrame:function(t,e){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(function(){t((new Date).getTime())},16)}).call(window,t,e)},cancelAnimationFrame:function(t){return(window.cancelAnimationFrame||function(t){clearTimeout(t)}).call(window,t)}},i.defaultSeriesPresentationOptions={lineWidth:1,strokeStyle:"#ffffff"},i.prototype.addTimeSeries=function(t,e){this.seriesSet.push({timeSeries:t,options:a.extend({},i.defaultSeriesPresentationOptions,e)}),t.options.resetBounds&&t.options.resetBoundsInterval>0&&(t.resetBoundsTimerId=setInterval(function(){t.resetBounds()},t.options.resetBoundsInterval))},i.prototype.removeTimeSeries=function(t){for(var e=this.seriesSet.length,i=0;i<e;i++)if(this.seriesSet[i].timeSeries===t){this.seriesSet.splice(i,1);break}t.resetBoundsTimerId&&clearInterval(t.resetBoundsTimerId)},i.prototype.getTimeSeriesOptions=function(t){for(var e=this.seriesSet.length,i=0;i<e;i++)if(this.seriesSet[i].timeSeries===t)return this.seriesSet[i].options},i.prototype.bringToFront=function(t){for(var e=this.seriesSet.length,i=0;i<e;i++)if(this.seriesSet[i].timeSeries===t){var a=this.seriesSet.splice(i,1);this.seriesSet.push(a[0]);break}},i.prototype.streamTo=function(t,e){this.canvas=t,this.delay=e,this.start()},i.prototype.resize=function(){var t,e,i=this.options.enableDpiScaling&&window?window.devicePixelRatio:1;this.options.responsive?(t=this.canvas.offsetWidth,e=this.canvas.offsetHeight,t!==this.lastWidth&&(this.lastWidth=t,this.canvas.setAttribute("width",Math.floor(t*i).toString())),e!==this.lastHeight&&(this.lastHeight=e,this.canvas.setAttribute("height",Math.floor(e*i).toString()))):1!==i&&(t=parseInt(this.canvas.getAttribute("width")),e=parseInt(this.canvas.getAttribute("height")),this.originalWidth&&Math.floor(this.originalWidth*i)===t||(this.originalWidth=t,this.canvas.setAttribute("width",Math.floor(t*i).toString()),this.canvas.style.width=t+"px",this.canvas.getContext("2d").scale(i,i)),this.originalHeight&&Math.floor(this.originalHeight*i)===e||(this.originalHeight=e,this.canvas.setAttribute("height",Math.floor(e*i).toString()),this.canvas.style.height=e+"px",this.canvas.getContext("2d").scale(i,i)))},i.prototype.start=function(){if(!this.frame){var t=function(){this.frame=i.AnimateCompatibility.requestAnimationFrame(function(){this.render(),t()}.bind(this))}.bind(this);t()}},i.prototype.stop=function(){this.frame&&(i.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame)},i.prototype.updateValueRange=function(){for(var t=this.options,e=Number.NaN,i=Number.NaN,a=0;a<this.seriesSet.length;a++){var s=this.seriesSet[a].timeSeries;isNaN(s.maxValue)||(e=isNaN(e)?s.maxValue:Math.max(e,s.maxValue)),isNaN(s.minValue)||(i=isNaN(i)?s.minValue:Math.min(i,s.minValue))}if(null!=t.maxValue?e=t.maxValue:e*=t.maxValueScale,null!=t.minValue?i=t.minValue:i-=Math.abs(i*t.minValueScale-i),this.options.yRangeFunction){var n=this.options.yRangeFunction({min:i,max:e});i=n.min,e=n.max}if(!isNaN(e)&&!isNaN(i)){var r=e-i-this.currentValueRange,l=i-this.currentVisMinValue;this.isAnimatingScale=Math.abs(r)>.1||Math.abs(l)>.1,this.currentValueRange+=t.scaleSmoothing*r,this.currentVisMinValue+=t.scaleSmoothing*l}this.valueRange={min:i,max:e}},i.prototype.render=function(t,e){var i=(new Date).getTime();if(!this.isAnimatingScale){var a=Math.min(1e3/6,this.options.millisPerPixel);if(i-this.lastRenderTimeMillis<a)return}this.resize(),this.lastRenderTimeMillis=i,t=t||this.canvas,e=e||i-(this.delay||0),e-=e%this.options.millisPerPixel;var s=t.getContext("2d"),n=this.options,r={top:0,left:0,width:t.clientWidth,height:t.clientHeight},l=e-r.width*n.millisPerPixel,o=function(t){var e=t-this.currentVisMinValue;return 0===this.currentValueRange?r.height:r.height-Math.round(e/this.currentValueRange*r.height)}.bind(this),h=function(t){return n.scrollBackwards?Math.round((e-t)/n.millisPerPixel):Math.round(r.width-(e-t)/n.millisPerPixel)};if(this.updateValueRange(),s.font=n.labels.fontSize+"px "+n.labels.fontFamily,s.save(),s.translate(r.left,r.top),s.beginPath(),s.rect(0,0,r.width,r.height),s.clip(),s.save(),s.fillStyle=n.grid.fillStyle,s.clearRect(0,0,r.width,r.height),s.fillRect(0,0,r.width,r.height),s.restore(),s.save(),s.lineWidth=n.grid.lineWidth,s.strokeStyle=n.grid.strokeStyle,n.grid.millisPerLine>0){s.beginPath();for(R=e-e%n.grid.millisPerLine;R>=l;R-=n.grid.millisPerLine){A=h(R);n.grid.sharpLines&&(A-=.5),s.moveTo(A,0),s.lineTo(A,r.height)}s.stroke(),s.closePath()}for(var d=1;d<n.grid.verticalSections;d++){var u=Math.round(d*r.height/n.grid.verticalSections);n.grid.sharpLines&&(u-=.5),s.beginPath(),s.moveTo(0,u),s.lineTo(r.width,u),s.stroke(),s.closePath()}if(n.grid.borderVisible&&(s.beginPath(),s.strokeRect(0,0,r.width,r.height),s.closePath()),s.restore(),n.horizontalLines&&n.horizontalLines.length)for(var m=0;m<n.horizontalLines.length;m++){var c=n.horizontalLines[m],f=Math.round(o(c.value))-.5;s.strokeStyle=c.color||"#ffffff",s.lineWidth=c.lineWidth||1,s.beginPath(),s.moveTo(0,f),s.lineTo(r.width,f),s.stroke(),s.closePath()}for(var g=0;g<this.seriesSet.length;g++){s.save();var p=this.seriesSet[g].timeSeries,v=p.data,S=this.seriesSet[g].options;p.dropOldData(l,n.maxDataSetLength),s.lineWidth=S.lineWidth,s.strokeStyle=S.strokeStyle,s.beginPath();for(var w=0,x=0,b=0,y=0;y<v.length&&1!==v.length;y++){var V=h(v[y][0]),T=o(v[y][1]);if(0===y)w=V,s.moveTo(V,T);else switch(n.interpolation){case"linear":case"line":s.lineTo(V,T);break;case"bezier":default:s.bezierCurveTo(Math.round((x+V)/2),b,Math.round(x+V)/2,T,V,T);break;case"step":s.lineTo(V,b),s.lineTo(V,T)}x=V,b=T}v.length>1&&(S.fillStyle&&(s.lineTo(r.width+S.lineWidth+1,b),s.lineTo(r.width+S.lineWidth+1,r.height+S.lineWidth+1),s.lineTo(w,r.height+S.lineWidth),s.fillStyle=S.fillStyle,s.fill()),S.strokeStyle&&"none"!==S.strokeStyle&&s.stroke(),s.closePath()),s.restore()}if(!n.labels.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){var N=n.yMaxFormatter(this.valueRange.max,n.labels.precision),P=n.yMinFormatter(this.valueRange.min,n.labels.precision),M=n.scrollBackwards?0:r.width-s.measureText(N).width-2,k=n.scrollBackwards?0:r.width-s.measureText(P).width-2;s.fillStyle=n.labels.fillStyle,s.fillText(N,M,n.labels.fontSize),s.fillText(P,k,r.height-2)}if(n.timestampFormatter&&n.grid.millisPerLine>0)for(var F=n.scrollBackwards?s.measureText(P).width:r.width-s.measureText(P).width+4,R=e-e%n.grid.millisPerLine;R>=l;R-=n.grid.millisPerLine){var A=h(R);if(!n.scrollBackwards&&A<F||n.scrollBackwards&&A>F){var B=new Date(R),W=n.timestampFormatter(B),L=s.measureText(W).width;F=n.scrollBackwards?A+L+2:A-L-2,s.fillStyle=n.labels.fillStyle,n.scrollBackwards?s.fillText(W,A,r.height-2):s.fillText(W,A-L,r.height-2)}}s.restore()},i.timeFormatter=function(t){function e(t){return(t<10?"0":"")+t}return e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())},t.TimeSeries=e,t.SmoothieChart=i}("undefined"==typeof exports?this:exports);