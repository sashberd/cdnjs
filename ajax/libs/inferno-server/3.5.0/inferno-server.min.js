!(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("inferno"),require("stream")):"function"==typeof define&&define.amd?define(["exports","inferno","stream"],t):t((e.Inferno=e.Inferno||{},e.Inferno.Server=e.Inferno.Server||{}),e.Inferno,e.stream)})(this,(function(e,t,r){"use strict";function n(e){var t=typeof e;return"string"===t||"number"===t}function o(e){return l(e)||a(e)}function i(e){return a(e)||!1===e||c(e)||l(e)}function u(e){return"function"==typeof e}function s(e){return"number"==typeof e}function a(e){return null===e}function c(e){return!0===e}function l(e){return void 0===e}function p(e){throw e||(e=k),new Error("Inferno Error: "+e)}function d(e,t){var r={};if(e)for(var n in e)r[n]=e[n];if(t)for(var o in t)r[o]=t[o];return r}function h(e){return String(e).replace(/[<>"'&]/g,I)}function f(e){return e.replace(P,"-$&").toLowerCase().replace(A,"-ms-")}function v(e){return!!E[e]}function m(e){if(n(e))return e;var r="";for(var i in e){var u=e[i],a=s(u)&&!t.internal_isUnitlessNumber.has(i)?"px":"";o(u)||(r+=f(i)+":"+h(u)+a+";")}return r}function y(e,r,s,l){var f=e.flags,g=e.type,S=e.props||t.EMPTY_OBJ,x=e.children;if(28&f){if(4&f){var T=new g(S,s);T._blockSetState=!1;var _;o(T.getChildContext)||(_=T.getChildContext()),o(_)||(s=d(s,_)),T.props===t.EMPTY_OBJ&&(T.props=S),T.context=s,T._pendingSetState=!0,T._unmounted=!1,u(T.componentWillMount)&&T.componentWillMount();var Q=T.render(S,e.context);return T._pendingSetState=!1,i(Q)?"\x3c!--!--\x3e":y(Q,e,s,!0)}var M=g(S,s);return i(M)?"\x3c!--!--\x3e":y(M,e,s,!0)}if(3970&f){var N,b="<"+g,k=v(g);if(o(e.className)||(b+=' class="'+h(e.className)+'"'),!a(S))for(var w in S){var I=S[w];"dangerouslySetInnerHTML"===w?N=I.__html:"style"===w?b+=' style="'+m(S.style)+'"':"children"===w||("defaultValue"===w?S.value||(b+=' value="'+h(I)+'"'):"defaultChecked"===w?S.checked||(b+=' checked="'+I+'"'):"option"===g&&"value"===w?I===r.props.value&&(b+=" selected"):n(I)?b+=" "+w+'="'+h(I)+'"':c(I)&&(b+=" "+w))}if(k)b+=">";else{if(b+=">",i(x))N&&(b+=N);else if(C(x))for(var P=0,A=x.length;P<A;P++){var E=x[P];n(E)?b+=""===E?" ":h(E):i(E)||(b+=y(E,e,s,0===P))}else n(x)?b+=""===x?" ":h(x):b+=y(x,e,s,!0);k||(b+="</"+g+">")}return b}if(1&f)return(l?"":"\x3c!----\x3e")+(""===x?" ":h(x));p()}function g(e){return y(e,{},{},!0)}function S(e){return y(e,{},{},!0)}function x(e){if(n(e))return e;var r="";for(var i in e){var u=e[i],a=s(u)&&!t.internal_isUnitlessNumber.has(i)?"px":"";o(u)||(r+=f(i)+":"+h(u)+a+";")}return r}function T(e){return new j(e,!1)}function _(e){return new j(e,!0)}function Q(e){if(n(e))return e;var r=[];for(var i in e){var u=e[i],a=s(u)&&!t.internal_isUnitlessNumber.has(i)?"px":"";o(u)||r.push(f(i)+":"+h(u)+a+";")}return r.join()}function M(e){var t=[];return(e&&Object.keys(e)||[]).forEach((function(r,o){var i=e[r];switch(r){case"children":case"dangerouslySetInnerHTML":case"style":return;default:n(i)?t.push(h(r)+'="'+h(i)+'"'):c(i)&&t.push(h(r))}})),t}function N(e){return new O(e,!1)}function b(e){return new O(e,!0)}var k="a runtime error occured! Use Inferno in development environment to find the error.",C=Array.isArray,w={'"':"&quot;","&":"&amp;","'":"&#039;","<":"&lt;",">":"&gt;"},I=function(e){return w[e]||e},P=/[A-Z]/g,A=/^ms-/,E={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},j=(function(e){function r(t,r){e.call(this),this.started=!1,this.collector=[1/0],this.promises=[],this.pushQueue=this.pushQueue.bind(this),t&&this.renderVNodeToQueue(t,null,r,null)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype._read=function(){setTimeout(this.pushQueue,0)},r.prototype.addToQueue=function(e,t){if(o(t))"string"==typeof e&&this.collector.length-1==0?this.push(e):"string"==typeof e&&"string"==typeof this.collector[this.collector.length-2]?this.collector[this.collector.length-2]+=e:this.collector.splice(-1,0,e);else{var r=this.promises[t].length-1;"string"==typeof this.promises[t][r]&&"string"==typeof e?this.promises[t][r]+=e:this.promises[t].push(e)}},r.prototype.pushQueue=function(){var e=this.collector[0];if("string"==typeof e)this.push(e),this.collector.shift();else if(e&&("object"==typeof e||u(e))&&u(e.then)){var t=this;e.then((function(e){(r=t.collector).splice.apply(r,[0,1].concat(t.promises[e])),t.promises[e]=null,setTimeout(t.pushQueue,0);var r})),this.collector[0]=null}else e===1/0&&this.emit("end")},r.prototype.renderVNodeToQueue=function(e,r,s,f){var m=this;if(i(e))this.addToQueue("\x3c!--!--\x3e",f);else{var y=e.flags,g=e.type,S=e.props||t.EMPTY_OBJ,T=e.children;if(28&y)if(4&y){var _=new g(S,r);_._blockSetState=!1;var Q;if(l(_.getChildContext)||(Q=_.getChildContext()),o(Q)||(r=d(r,Q)),_.props===t.EMPTY_OBJ&&(_.props=S),_.context=r,_._pendingSetState=!0,_._unmounted=!1,u(_.componentWillMount)&&_.componentWillMount(),u(_.getInitialProps)){var M=_.getInitialProps(_.props,_.context);if(M){if(Promise.resolve(M)===M){var N=this.promises.push([])-1;return void this.addToQueue(M.then((function(e){return _._pendingSetState=!1,"object"==typeof e&&(_.props=d(_.props,e)),m.renderVNodeToQueue(_.render(_.props,_.context),_.context,!0,N),setTimeout(m.pushQueue,0),N})),f)}_.props=d(_.props,M)}}var b=_.render(S,e.context);_._pendingSetState=!1,this.renderVNodeToQueue(b,r,!0,f)}else{var k=g(S,r);this.renderVNodeToQueue(k,r,!0,f)}else if(3970&y){var w,I="<"+g,P=v(g);if(o(e.className)||(I+=' class="'+h(e.className)+'"'),!a(S))for(var A in S){var E=S[A];"dangerouslySetInnerHTML"===A?w=E.__html:"style"===A?I+=' style="'+x(S.style)+'"':"children"===A||("defaultValue"===A?S.value||(I+=' value="'+h(E)+'"'):"defaultChecked"===A?S.checked||(I+=' checked="'+E+'"'):n(E)?I+=" "+A+'="'+h(E)+'"':c(E)&&(I+=" "+A))}if(P)this.addToQueue(I+">",f);else{if(I+=">",i(T)){if(w)return void this.addToQueue(I+w+"</"+g+">",f)}else{if(!C(T))return n(T)?void this.addToQueue(I+h(T)+"</"+g+">",f):(this.addToQueue(I,f),this.renderVNodeToQueue(T,r,!0,f),void this.addToQueue("</"+g+">",f));this.addToQueue(I,f),I="";for(var j=0,V=T.length;j<V;j++){var O=T[j];n(O)?m.addToQueue(h(T),f):i(O)||m.renderVNodeToQueue(O,r,0===j,f)}}P||this.addToQueue(I+"</"+g+">",f)}}else 1&y?this.addToQueue((s?"":"\x3c!----\x3e")+h(T),f):p()}},r})(r.Readable),V=Promise.resolve(),O=(function(e){function t(t,r){e.call(this),this.started=!1,this.initNode=t,this.staticMarkup=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._read=function(){var e=this;this.started||(this.started=!0,V.then((function(){return e.renderNode(e.initNode,null,e.staticMarkup)})).then((function(){e.push(null)})).catch((function(t){e.emit("error",t)})))},t.prototype.renderNode=function(e,t,r){if(!i(e)){var n=e.flags;return 28&n?this.renderComponent(e,r,t,4&n):3970&n?this.renderElement(e,r,t):this.renderText(e,r,t)}},t.prototype.renderComponent=function(e,t,r,n){var i=this,u=e.type,s=e.props;if(!n)return this.renderNode(u(s),r,t);var a=new u(s);a._blockSetState=!1;var c;return l(a.getChildContext)||(c=a.getChildContext()),o(c)||(r=d(r,c)),a.context=r,a._pendingSetState=!0,Promise.resolve(a.componentWillMount&&a.componentWillMount()).then((function(){var e=a.render();return a._pendingSetState=!1,i.renderNode(e,r,t)}))},t.prototype.renderChildren=function(e,t){var r=this;if(n(e))return this.push(h(e));if(e){var o=C(e);if(!o&&!i(e))return this.renderNode(e,t,!1);if(!o)throw new Error("invalid component");return e.reduce((function(e,o){return e.then((function(e){var u=n(o);return u?(!0===e&&r.push("\x3c!----\x3e"),u&&r.push(h(o)),!0):C(o)?(r.push("\x3c!----\x3e"),Promise.resolve(r.renderChildren(o)).then((function(){return r.push("\x3c!--!--\x3e"),!0}))):i(o)?void 0:(1&o.flags&&(e&&r.push("\x3c!----\x3e"),e=!0),Promise.resolve(r.renderNode(o,t,!1)).then((function(){return!!(1&o.flags)})))}))}),Promise.resolve(!1))}},t.prototype.renderText=function(e,t,r){var n=this;return V.then((function(t){return n.push(e.children),t}))},t.prototype.renderElement=function(e,t,r){var n=this,i=e.type,u=e.props,s=M(u),a="",c=e.className;if(o(c)||s.push('class="'+h(c)+'"'),u){var l=u.style;l&&s.push('style="'+Q(l)+'"'),u.dangerouslySetInnerHTML&&(a=u.dangerouslySetInnerHTML.__html)}if(t&&s.push("data-infernoroot"),this.push("<"+i+(s.length>0?" "+s.join(" "):"")+">"),!v(i))return a?(this.push(a),void this.push("</"+i+">")):Promise.resolve(this.renderChildren(e.children,r)).then((function(){n.push("</"+i+">")}))},t})(r.Readable),L={RenderQueueStream:j,RenderStream:O,renderToStaticMarkup:S,renderToString:g,streamAsStaticMarkup:b,streamAsString:N,streamQueueAsStaticMarkup:_,streamQueueAsString:T};e.default=L,e.RenderQueueStream=j,e.RenderStream=O,e.renderToStaticMarkup=S,e.renderToString=g,e.streamAsStaticMarkup=b,e.streamAsString=N,e.streamQueueAsStaticMarkup=_,e.streamQueueAsString=T,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbbnVsbF0sInNvdXJjZXNDb250ZW50IjpbbnVsbF0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUMsQ0FBQSx3UkFBd1IsQ0FBQSxNQUFNLENBQUEseTlFQUF5OUUsQ0FBQSwrSkFBK0osQ0FBQSw2YUFBNmEsQ0FBQSxpNUJBQWk1QixDQUFBLDJIQUEySCxDQUFBLHVvQkFBdW9CLENBQUEsaUxBQWlMLENBQUEsK2dDQUErZ0MsQ0FBQSxtQ0FBbUMsQ0FBQSx5UUFBeVEsQ0FBQSwrREFBK0QsQ0FBQSxPQUFPLENBQUEsd0JBQXdCLENBQUEsUUFBUSxDQUFBLDhCQUE4QixDQUFBLGdmQUFnZixDQUFBLDZFQUE2RSxDQUFBLDhNQUE4TSxDQUFBLDRCQUE0QixDQUFBLDZKQUE2SixDQUFBLDhDQUE4QyxDQUFBLHdHQUF3RyxDQUFBLCtCQUErQixDQUFBLEdBQUcsQ0FBQSxFQUFFLENBQUEsd0ZBQXdGLENBQUEsd0NBQXdDLENBQUEsK2JBQStiLENBQUEsOEJBQThCLENBQUEsS0FBSyxDQUFBLHdhQUF3YSxDQUFBIn0=
