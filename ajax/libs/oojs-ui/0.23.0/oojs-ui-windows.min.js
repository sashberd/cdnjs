/*! OOjs UI v0.23.0 | http://oojs.mit-license.org */
!function(t){"use strict";t.ui.ActionWidget=function(e){e=$.extend({framed:!1},e),t.ui.ActionWidget.parent.call(this,e),t.ui.mixin.PendingElement.call(this,e),this.action=e.action||"",this.modes=e.modes||[],this.width=0,this.height=0,this.$element.addClass("oo-ui-actionWidget")},t.inheritClass(t.ui.ActionWidget,t.ui.ButtonWidget),t.mixinClass(t.ui.ActionWidget,t.ui.mixin.PendingElement),t.ui.ActionWidget.prototype.hasMode=function(t){return-1!==this.modes.indexOf(t)},t.ui.ActionWidget.prototype.getAction=function(){return this.action},t.ui.ActionWidget.prototype.getModes=function(){return this.modes.slice()},t.ui.ActionSet=function(e){e=e||{},t.EventEmitter.call(this),this.list=[],this.categories={actions:"getAction",flags:"getFlags",modes:"getModes"},this.categorized={},this.special={},this.others=[],this.organized=!1,this.changing=!1,this.changed=!1},t.mixinClass(t.ui.ActionSet,t.EventEmitter),t.ui.ActionSet.static.specialFlags=["safe","primary"],t.ui.ActionSet.prototype.onActionChange=function(){this.organized=!1,this.changing?this.changed=!0:this.emit("change")},t.ui.ActionSet.prototype.isSpecial=function(t){var e;for(e in this.special)if(t===this.special[e])return!0;return!1},t.ui.ActionSet.prototype.get=function(t){var e,i,o,n,s,r,a,c;if(t){this.organize(),c=[];for(n in this.categorized)if(o=t[n])for(Array.isArray(o)||(o=[o]),e=0,i=o.length;e<i;e++)s=this.categorized[n][o[e]],Array.isArray(s)&&c.push.apply(c,s);for(e=0,i=c.length;e<i;e++)a=c[e],(void 0!==t.visible&&a.isVisible()!==t.visible||void 0!==t.disabled&&a.isDisabled()!==t.disabled)&&(c.splice(e,1),i--,e--);for(e=0,i=c.length;e<i;e++)for(a=c[e],r=c.lastIndexOf(a);r!==e;)c.splice(r,1),i--,r=c.lastIndexOf(a);return c}return this.list.slice()},t.ui.ActionSet.prototype.getSpecial=function(){return this.organize(),$.extend({},this.special)},t.ui.ActionSet.prototype.getOthers=function(){return this.organize(),this.others.slice()},t.ui.ActionSet.prototype.setMode=function(t){var e,i,o;for(this.changing=!0,e=0,i=this.list.length;e<i;e++)(o=this.list[e]).toggle(o.hasMode(t));return this.organized=!1,this.changing=!1,this.emit("change"),this},t.ui.ActionSet.prototype.setAbilities=function(t){var e,i,o,n;for(e=0,i=this.list.length;e<i;e++)void 0!==t[o=(n=this.list[e]).getAction()]&&n.setDisabled(!t[o]);return this},t.ui.ActionSet.prototype.forEach=function(t,e){return this.changed=!1,this.changing=!0,this.get(t).forEach(e),this.changing=!1,this.changed&&this.emit("change"),this},t.ui.ActionSet.prototype.add=function(t){var e,i,o;for(this.changing=!0,e=0,i=t.length;e<i;e++)(o=t[e]).connect(this,{click:["emit","click",o],toggle:["onActionChange"]}),this.list.push(o);return this.organized=!1,this.emit("add",t),this.changing=!1,this.emit("change"),this},t.ui.ActionSet.prototype.remove=function(t){var e,i,o,n;for(this.changing=!0,e=0,i=t.length;e<i;e++)n=t[e],-1!==(o=this.list.indexOf(n))&&(n.disconnect(this),this.list.splice(o,1));return this.organized=!1,this.emit("remove",t),this.changing=!1,this.emit("change"),this},t.ui.ActionSet.prototype.clear=function(){var t,e,i=this.list.slice();for(this.changing=!0,t=0,e=this.list.length;t<e;t++)this.list[t].disconnect(this);return this.list=[],this.organized=!1,this.emit("remove",i),this.changing=!1,this.emit("change"),this},t.ui.ActionSet.prototype.organize=function(){var t,e,i,o,n,s,r,a,c,l,h=this.constructor.static.specialFlags;if(!this.organized){for(this.categorized={},this.special={},this.others=[],t=0,e=this.list.length;t<e;t++)if((s=this.list[t]).isVisible()){for(r in this.categories)for(this.categorized[r]||(this.categorized[r]={}),a=s[this.categories[r]](),Array.isArray(a)||(a=[a]),i=0,o=a.length;i<o;i++)c=a[i],this.categorized[r][c]||(this.categorized[r][c]=[]),this.categorized[r][c].push(s);for(l=!1,i=0,o=h.length;i<o;i++)if(n=h[i],!this.special[n]&&s.hasFlag(n)){this.special[n]=s,l=!0;break}l||this.others.push(s)}this.organized=!0}return this},t.ui.Error=function(e,i){t.isPlainObject(e)&&void 0===i&&(e=(i=e).message),i=i||{},this.message=e instanceof jQuery?e:String(e),this.recoverable=void 0===i.recoverable||!!i.recoverable,this.warning=!!i.warning},t.initClass(t.ui.Error),t.ui.Error.prototype.isRecoverable=function(){return this.recoverable},t.ui.Error.prototype.isWarning=function(){return this.warning},t.ui.Error.prototype.getMessage=function(){return this.message instanceof jQuery?this.message.clone():$("<div>").text(this.message).contents()},t.ui.Error.prototype.getMessageText=function(){return this.message instanceof jQuery?this.message.text():this.message},t.ui.Process=function(t,e){this.steps=[],void 0!==t&&this.next(t,e)},t.initClass(t.ui.Process),t.ui.Process.prototype.execute=function(){function e(e){return function(){var i,o=e.callback.call(e.context);if(!1===o)return $.Deferred().reject([]).promise();if("number"==typeof o){if(o<0)throw new Error("Cannot go back in time: flux capacitor is out of service");return i=$.Deferred(),setTimeout(i.resolve,o),i.promise()}return o instanceof t.ui.Error?$.Deferred().reject([o]).promise():Array.isArray(o)&&o.length&&o[0]instanceof t.ui.Error?$.Deferred().reject(o).promise():o&&$.isFunction(o.promise)?o.promise():$.Deferred().resolve().promise()}}var i,o,n;if(this.steps.length)for(n=e(this.steps[0])(),i=1,o=this.steps.length;i<o;i++)n=n.then(e(this.steps[i]));else n=$.Deferred().resolve().promise();return n},t.ui.Process.prototype.createStep=function(t,e){if("number"==typeof t||$.isFunction(t.promise))return{callback:function(){return t},context:null};if($.isFunction(t))return{callback:t,context:e};throw new Error("Cannot create process step: number, promise or function expected")},t.ui.Process.prototype.first=function(t,e){return this.steps.unshift(this.createStep(t,e)),this},t.ui.Process.prototype.next=function(t,e){return this.steps.push(this.createStep(t,e)),this},t.ui.WindowInstance=function(){var t={opening:$.Deferred(),opened:$.Deferred(),closing:$.Deferred(),closed:$.Deferred()};this.deferreds=t,this.opening=t.opening.promise(),this.opened=this.opening.then(function(){return t.opened}),this.closing=this.opened.then(function(){return t.closing}),this.closed=this.closing.then(function(){return t.closed})},t.initClass(t.ui.WindowInstance),t.ui.WindowInstance.prototype.isOpening=function(){return"pending"===this.deferreds.opened.state()},t.ui.WindowInstance.prototype.isOpened=function(){return"resolved"===this.deferreds.opened.state()&&"pending"===this.deferreds.closing.state()},t.ui.WindowInstance.prototype.isClosing=function(){return"resolved"===this.deferreds.closing.state()&&"pending"===this.deferreds.closed.state()},t.ui.WindowInstance.prototype.isClosed=function(){return"resolved"===this.deferreds.closed.state()},t.ui.WindowManager=function(e){e=e||{},t.ui.WindowManager.parent.call(this,e),t.EventEmitter.call(this),this.factory=e.factory,this.modal=void 0===e.modal||!!e.modal,this.windows={},this.compatOpened=null,this.preparingToOpen=null,this.preparingToClose=null,this.currentWindow=null,this.globalEvents=!1,this.$returnFocusTo=null,this.$ariaHidden=null,this.onWindowResizeTimeout=null,this.onWindowResizeHandler=this.onWindowResize.bind(this),this.afterWindowResizeHandler=this.afterWindowResize.bind(this),this.$element.addClass("oo-ui-windowManager").toggleClass("oo-ui-windowManager-modal",this.modal)},t.inheritClass(t.ui.WindowManager,t.ui.Element),t.mixinClass(t.ui.WindowManager,t.EventEmitter),t.ui.WindowManager.static.sizes={small:{width:300},medium:{width:500},large:{width:700},larger:{width:900},full:{width:"100%",height:"100%"}},t.ui.WindowManager.static.defaultSize="medium",t.ui.WindowManager.prototype.onWindowResize=function(){clearTimeout(this.onWindowResizeTimeout),this.onWindowResizeTimeout=setTimeout(this.afterWindowResizeHandler,200)},t.ui.WindowManager.prototype.afterWindowResize=function(){this.currentWindow&&this.updateWindowSize(this.currentWindow)},t.ui.WindowManager.prototype.isOpening=function(t){return t===this.currentWindow&&!!this.lifecycle&&this.lifecycle.isOpening()},t.ui.WindowManager.prototype.isClosing=function(t){return t===this.currentWindow&&!!this.lifecycle&&this.lifecycle.isClosing()},t.ui.WindowManager.prototype.isOpened=function(t){return t===this.currentWindow&&!!this.lifecycle&&this.lifecycle.isOpened()},t.ui.WindowManager.prototype.hasWindow=function(t){var e;for(e in this.windows)if(this.windows[e]===t)return!0;return!1},t.ui.WindowManager.prototype.getSetupDelay=function(){return 0},t.ui.WindowManager.prototype.getReadyDelay=function(){return 0},t.ui.WindowManager.prototype.getHoldDelay=function(){return 0},t.ui.WindowManager.prototype.getTeardownDelay=function(){return this.modal?250:0},t.ui.WindowManager.prototype.getWindow=function(e){var i=$.Deferred(),o=this.windows[e];return o instanceof t.ui.Window?i.resolve(o):this.factory?this.factory.lookup(e)?(o=this.factory.create(e),this.addWindows([o]),i.resolve(o)):i.reject(new t.ui.Error("Cannot auto-instantiate window: symbolic name is unrecognized by the factory")):i.reject(new t.ui.Error("Cannot get unmanaged window: symbolic name unrecognized as a managed window")),i.promise()},t.ui.WindowManager.prototype.getCurrentWindow=function(){return this.currentWindow},t.ui.WindowManager.prototype.openWindow=function(e,i,o,n){var s,r=this;return i=i||{},o=o||new t.ui.WindowInstance,n=n||$.Deferred(),["state","always","catch","pipe","then","promise","progress","done","fail"].forEach(function(e){o[e]=function(){return t.ui.warnDeprecation("Using the return value of openWindow as a promise is deprecated. Use .openWindow( ... ).opening."+e+"( ... ) instead."),n[e].apply(this,arguments)}}),"string"==typeof e?(this.getWindow(e).then(function(t){r.openWindow(t,i,o,n)},function(t){o.deferreds.opening.reject(t)}),o):(this.hasWindow(e)?this.lifecycle&&this.lifecycle.isOpened()?s="Cannot open window: another window is open":(this.preparingToOpen||this.lifecycle&&this.lifecycle.isOpening())&&(s="Cannot open window: another window is opening"):s="Cannot open window: window is not attached to manager",s?(n.reject(new t.ui.Error(s)),o.deferreds.opening.reject(new t.ui.Error(s)),o):(this.preparingToOpen=$.when(this.lifecycle&&this.lifecycle.closed),this.preparingToOpen.done(function(){r.modal&&(r.toggleGlobalEvents(!0),r.toggleAriaIsolation(!0)),r.$returnFocusTo=void 0!==i.$returnFocusTo?i.$returnFocusTo:$(document.activeElement),r.currentWindow=e,r.lifecycle=o,r.preparingToOpen=null,r.emit("opening",e,n,i),o.deferreds.opening.resolve(i),setTimeout(function(){r.compatOpened=$.Deferred(),e.setup(i).then(function(){r.updateWindowSize(e),n.notify({state:"setup"}),setTimeout(function(){e.ready(i).then(function(){n.notify({state:"ready"}),o.deferreds.opened.resolve(i),n.resolve(r.compatOpened.promise(),i)},function(){o.deferreds.opened.reject(),n.reject(),r.closeWindow(e)})},r.getReadyDelay())},function(){o.deferreds.opened.reject(),n.reject(),r.closeWindow(e)})},r.getSetupDelay())}),o))},t.ui.WindowManager.prototype.closeWindow=function(e,i){var o,n,s=this,r=$.Deferred(),a=this.lifecycle;return"string"==typeof e?e=this.windows[e]:this.hasWindow(e)||(e=null),a?e?e!==this.currentWindow||this.lifecycle.isClosed()?o="Cannot close window: window already closed with different data":(this.preparingToClose||this.lifecycle.isClosing())&&(o="Cannot close window: window already closing with different data"):o="Cannot close window: window is not attached to manager":o="Cannot close window: no window is currently open",o&&((a=new t.ui.WindowInstance).deferreds.opening.resolve({}),a.deferreds.opened.resolve({})),["state","always","catch","pipe","then","promise","progress","done","fail"].forEach(function(e){a[e]=function(){return t.ui.warnDeprecation("Using the return value of closeWindow as a promise is deprecated. Use .closeWindow( ... ).closed."+e+"( ... ) instead."),r[e].apply(this,arguments)}}),o?(r.reject(new t.ui.Error(o)),a.deferreds.closing.reject(new t.ui.Error(o)),a):(this.preparingToClose=$.when(this.lifecycle.opened),this.preparingToClose.always(function(){s.preparingToClose=null,s.emit("closing",e,r,i),a.deferreds.closing.resolve(i),n=s.compatOpened,s.compatOpened=null,n.resolve(r.promise(),i),setTimeout(function(){e.hold(i).then(function(){r.notify({state:"hold"}),setTimeout(function(){e.teardown(i).then(function(){r.notify({state:"teardown"}),s.modal&&(s.toggleGlobalEvents(!1),s.toggleAriaIsolation(!1)),s.$returnFocusTo&&s.$returnFocusTo.length&&s.$returnFocusTo[0].focus(),s.currentWindow=null,s.lifecycle=null,a.deferreds.closed.resolve(i),r.resolve(i)})},s.getTeardownDelay())})},s.getHoldDelay())}),a)},t.ui.WindowManager.prototype.addWindows=function(e){var i,o,n,s,r;if(Array.isArray(e))for(r={},i=0,o=e.length;i<o;i++){if(!(s=e[i].constructor.static.name))throw new Error("Windows must have a `name` static property defined.");r[s]=e[i]}else t.isPlainObject(e)&&(r=e);for(s in r)n=r[s],this.windows[s]=n.toggle(!1),this.$element.append(n.$element),n.setManager(this)},t.ui.WindowManager.prototype.removeWindows=function(t){var e,i,o,n,s,r=this,a=[];for(e=0,i=t.length;e<i;e++){if(n=t[e],!(o=this.windows[n]))throw new Error("Cannot remove window");s=function(t,e){delete r.windows[t],e.$element.detach()}.bind(null,n,o),a.push(this.closeWindow(n).closed.then(s,s))}return $.when.apply($,a)},t.ui.WindowManager.prototype.clearWindows=function(){return this.removeWindows(Object.keys(this.windows))},t.ui.WindowManager.prototype.updateWindowSize=function(t){var e;if(t===this.currentWindow)return e="full"===t.getSize(),this.$element.toggleClass("oo-ui-windowManager-fullscreen",e),this.$element.toggleClass("oo-ui-windowManager-floating",!e),t.setDimensions(t.getSizeProperties()),this.emit("resize",t),this},t.ui.WindowManager.prototype.toggleGlobalEvents=function(t){var e,i,o=$(this.getElementDocument().body),n=o.data("windowManagerGlobalEvents")||0;return(t=void 0===t?!!this.globalEvents:!!t)?this.globalEvents||($(this.getElementWindow()).on({"orientationchange resize":this.onWindowResizeHandler}),0===n&&(e=window.innerWidth-document.documentElement.clientWidth,i=parseFloat(o.css("margin-right"))||0,o.css({overflow:"hidden","margin-right":i+e})),n++,this.globalEvents=!0):this.globalEvents&&($(this.getElementWindow()).off({"orientationchange resize":this.onWindowResizeHandler}),0===--n&&o.css({overflow:"","margin-right":""}),this.globalEvents=!1),o.data("windowManagerGlobalEvents",n),this},t.ui.WindowManager.prototype.toggleAriaIsolation=function(t){return(t=void 0===t?!this.$ariaHidden:!!t)?this.$ariaHidden||(this.$ariaHidden=$("body").children().not(this.$element.parentsUntil("body").last()).attr("aria-hidden","")):this.$ariaHidden&&(this.$ariaHidden.removeAttr("aria-hidden"),this.$ariaHidden=null),this},t.ui.WindowManager.prototype.destroy=function(){this.toggleGlobalEvents(!1),this.toggleAriaIsolation(!1),this.clearWindows(),this.$element.remove()},t.ui.Window=function(e){e=e||{},t.ui.Window.parent.call(this,e),t.EventEmitter.call(this),this.manager=null,this.size=e.size||this.constructor.static.size,this.$frame=$("<div>"),this.$overlay=$("<div>"),this.$content=$("<div>"),this.$focusTrapBefore=$("<div>").prop("tabIndex",0),this.$focusTrapAfter=$("<div>").prop("tabIndex",0),this.$focusTraps=this.$focusTrapBefore.add(this.$focusTrapAfter),this.$overlay.addClass("oo-ui-window-overlay"),this.$content.addClass("oo-ui-window-content").attr("tabindex",0),this.$frame.addClass("oo-ui-window-frame").append(this.$focusTrapBefore,this.$content,this.$focusTrapAfter),this.$element.addClass("oo-ui-window").append(this.$frame,this.$overlay),this.visible=!1,this.$element.addClass("oo-ui-element-hidden")},t.inheritClass(t.ui.Window,t.ui.Element),t.mixinClass(t.ui.Window,t.EventEmitter),t.ui.Window.static.size="medium",t.ui.Window.prototype.onMouseDown=function(t){if(t.target===this.$element[0])return!1},t.ui.Window.prototype.isInitialized=function(){return!!this.manager},t.ui.Window.prototype.isVisible=function(){return this.visible},t.ui.Window.prototype.isOpening=function(){return this.manager.isOpening(this)},t.ui.Window.prototype.isClosing=function(){return this.manager.isClosing(this)},t.ui.Window.prototype.isOpened=function(){return this.manager.isOpened(this)},t.ui.Window.prototype.getManager=function(){return this.manager},t.ui.Window.prototype.getSize=function(){var e=t.ui.Element.static.getDimensions(this.getElementWindow()),i=this.manager.constructor.static.sizes,o=this.size;return i[o]||(o=this.manager.constructor.static.defaultSize),"full"!==o&&e.rect.right-e.rect.left<i[o].width&&(o="full"),o},t.ui.Window.prototype.getSizeProperties=function(){return this.manager.constructor.static.sizes[this.getSize()]},t.ui.Window.prototype.withoutSizeTransitions=function(t){var e=this.$frame.css("transition-property")+" "+this.$frame.css("transition-duration")+" "+this.$frame.css("transition-timing-function")+" "+this.$frame.css("transition-delay");this.$frame.css("transition","none"),t(),this.$frame.height(),this.$frame.css("transition",e)},t.ui.Window.prototype.getContentHeight=function(){var t,e=this,i=this.$body[0].style,o=this.$frame[0].style;return this.withoutSizeTransitions(function(){var n=o.height,s=i.position;o.height="1px",i.position="relative",t=e.getBodyHeight(),o.height=n,i.position=s}),this.$frame.outerHeight()-this.$frame.innerHeight()+(this.$head.outerHeight(!0)+t+this.$foot.outerHeight(!0))},t.ui.Window.prototype.getBodyHeight=function(){return this.$body[0].scrollHeight},t.ui.Window.prototype.getDir=function(){return t.ui.Element.static.getDir(this.$content)||"ltr"},t.ui.Window.prototype.getSetupProcess=function(){return new t.ui.Process},t.ui.Window.prototype.getReadyProcess=function(){return new t.ui.Process},t.ui.Window.prototype.getHoldProcess=function(){return new t.ui.Process},t.ui.Window.prototype.getTeardownProcess=function(){return new t.ui.Process},t.ui.Window.prototype.setManager=function(t){if(this.manager)throw new Error("Cannot set window manager, window already has a manager");return this.manager=t,this.initialize(),this},t.ui.Window.prototype.setSize=function(t){return this.size=t,this.updateSize(),this},t.ui.Window.prototype.updateSize=function(){if(!this.manager)throw new Error("Cannot update window size, must be attached to a manager");return this.manager.updateWindowSize(this),this},t.ui.Window.prototype.setDimensions=function(t){var e,i=this,o=this.$frame[0].style;return void 0===t.height?this.withoutSizeTransitions(function(){var n=o.width;i.$frame.css("width",t.width||""),e=i.getContentHeight(),o.width=n}):e=t.height,this.$frame.css({width:t.width||"",minWidth:t.minWidth||"",maxWidth:t.maxWidth||"",height:e||"",minHeight:t.minHeight||"",maxHeight:t.maxHeight||""}),this},t.ui.Window.prototype.initialize=function(){if(!this.manager)throw new Error("Cannot initialize window, must be attached to a manager");return this.$head=$("<div>"),this.$body=$("<div>"),this.$foot=$("<div>"),this.$document=$(this.getElementDocument()),this.$element.on("mousedown",this.onMouseDown.bind(this)),this.$head.addClass("oo-ui-window-head"),this.$body.addClass("oo-ui-window-body"),this.$foot.addClass("oo-ui-window-foot"),this.$content.append(this.$head,this.$body,this.$foot),this},t.ui.Window.prototype.onFocusTrapFocused=function(e){var i=this.$focusTrapBefore.is(e.target),o=t.ui.findFocusable(this.$content,i);o?o.focus():this.$content.focus()},t.ui.Window.prototype.open=function(t){if(!this.manager)throw new Error("Cannot open window, must be attached to a manager");return this.manager.openWindow(this,t)},t.ui.Window.prototype.close=function(t){if(!this.manager)throw new Error("Cannot close window, must be attached to a manager");return this.manager.closeWindow(this,t)},t.ui.Window.prototype.setup=function(e){var i=this;return this.toggle(!0),this.focusTrapHandler=t.ui.bind(this.onFocusTrapFocused,this),this.$focusTraps.on("focus",this.focusTrapHandler),this.getSetupProcess(e).execute().then(function(){i.$element.addClass("oo-ui-window-active oo-ui-window-setup").width(),i.$content.addClass("oo-ui-window-content-setup").width()})},t.ui.Window.prototype.ready=function(t){var e=this;return this.$content.focus(),this.getReadyProcess(t).execute().then(function(){e.$element.addClass("oo-ui-window-ready").width(),e.$content.addClass("oo-ui-window-content-ready").width()})},t.ui.Window.prototype.hold=function(e){var i=this;return this.getHoldProcess(e).execute().then(function(){var e=i.$content.find(t.ui.Element.static.getDocument(i.$content).activeElement);e.length&&e[0].blur(),i.$element.removeClass("oo-ui-window-ready").width(),i.$content.removeClass("oo-ui-window-content-ready").width()})},t.ui.Window.prototype.teardown=function(t){var e=this;return this.getTeardownProcess(t).execute().then(function(){e.$element.removeClass("oo-ui-window-active oo-ui-window-setup").width(),e.$content.removeClass("oo-ui-window-content-setup").width(),e.$focusTraps.off("focus",e.focusTrapHandler),e.toggle(!1)})},t.ui.Dialog=function(e){t.ui.Dialog.parent.call(this,e),t.ui.mixin.PendingElement.call(this),this.actions=new t.ui.ActionSet,this.attachedActions=[],this.currentAction=null,this.onDialogKeyDownHandler=this.onDialogKeyDown.bind(this),this.actions.connect(this,{click:"onActionClick",change:"onActionsChange"}),this.$element.addClass("oo-ui-dialog").attr("role","dialog")},t.inheritClass(t.ui.Dialog,t.ui.Window),t.mixinClass(t.ui.Dialog,t.ui.mixin.PendingElement),t.ui.Dialog.static.name="",t.ui.Dialog.static.title="",t.ui.Dialog.static.actions=[],t.ui.Dialog.static.escapable=!0,t.ui.Dialog.prototype.onDialogKeyDown=function(e){var i;e.which===t.ui.Keys.ESCAPE&&this.constructor.static.escapable?(this.executeAction(""),e.preventDefault(),e.stopPropagation()):e.which===t.ui.Keys.ENTER&&(e.ctrlKey||e.metaKey)&&(i=this.actions.get({flags:"primary",visible:!0,disabled:!1})).length>0&&(this.executeAction(i[0].getAction()),e.preventDefault(),e.stopPropagation())},t.ui.Dialog.prototype.onActionClick=function(t){this.isPending()||this.executeAction(t.getAction())},t.ui.Dialog.prototype.onActionsChange=function(){this.detachActions(),this.isClosing()||this.attachActions()},t.ui.Dialog.prototype.getActions=function(){return this.actions},t.ui.Dialog.prototype.getActionProcess=function(e){return(new t.ui.Process).next(function(){e||this.close()},this)},t.ui.Dialog.prototype.getSetupProcess=function(e){return e=e||{},t.ui.Dialog.parent.prototype.getSetupProcess.call(this,e).next(function(){var t=this.constructor.static,i=void 0!==e.actions?e.actions:t.actions,o=void 0!==e.title?e.title:t.title;this.title.setLabel(o).setTitle(o),this.actions.add(this.getActionWidgets(i)),this.$element.on("keydown",this.onDialogKeyDownHandler)},this)},t.ui.Dialog.prototype.getTeardownProcess=function(e){return t.ui.Dialog.parent.prototype.getTeardownProcess.call(this,e).first(function(){this.$element.off("keydown",this.onDialogKeyDownHandler),this.actions.clear(),this.currentAction=null},this)},t.ui.Dialog.prototype.initialize=function(){t.ui.Dialog.parent.prototype.initialize.call(this),this.title=new t.ui.LabelWidget,this.$content.addClass("oo-ui-dialog-content"),this.$element.attr("aria-labelledby",this.title.getElementId()),this.setPendingElement(this.$head)},t.ui.Dialog.prototype.getActionWidgets=function(e){var i,o,n=[];for(i=0,o=e.length;i<o;i++)n.push(new t.ui.ActionWidget(e[i]));return n},t.ui.Dialog.prototype.attachActions=function(){this.attachedActions=this.actions.get()},t.ui.Dialog.prototype.detachActions=function(){var t,e;for(t=0,e=this.attachedActions.length;t<e;t++)this.attachedActions[t].$element.detach();this.attachedActions=[]},t.ui.Dialog.prototype.executeAction=function(t){return this.pushPending(),this.currentAction=t,this.getActionProcess(t).execute().always(this.popPending.bind(this))},t.ui.MessageDialog=function(e){t.ui.MessageDialog.parent.call(this,e),this.verticalActionLayout=null,this.$element.addClass("oo-ui-messageDialog")},t.inheritClass(t.ui.MessageDialog,t.ui.Dialog),t.ui.MessageDialog.static.name="message",t.ui.MessageDialog.static.size="small",t.ui.MessageDialog.static.title=null,t.ui.MessageDialog.static.message=null,t.ui.MessageDialog.static.actions=[{action:"accept",label:t.ui.deferMsg("ooui-dialog-message-accept"),flags:"primary"},{action:"reject",label:t.ui.deferMsg("ooui-dialog-message-reject"),flags:"safe"}],t.ui.MessageDialog.prototype.setManager=function(e){return t.ui.MessageDialog.parent.prototype.setManager.call(this,e),this.manager.connect(this,{resize:"onResize"}),this},t.ui.MessageDialog.prototype.onResize=function(){var t=this;t.fitActions(),setTimeout(function(){t.fitActions()},300)},t.ui.MessageDialog.prototype.toggleVerticalActionLayout=function(t){return(t=void 0===t?!this.verticalActionLayout:!!t)!==this.verticalActionLayout&&(this.verticalActionLayout=t,this.$actions.toggleClass("oo-ui-messageDialog-actions-vertical",t).toggleClass("oo-ui-messageDialog-actions-horizontal",!t)),this},t.ui.MessageDialog.prototype.getActionProcess=function(e){return e?new t.ui.Process(function(){this.close({action:e})},this):t.ui.MessageDialog.parent.prototype.getActionProcess.call(this,e)},t.ui.MessageDialog.prototype.getSetupProcess=function(e){return e=e||{},t.ui.MessageDialog.parent.prototype.getSetupProcess.call(this,e).next(function(){this.title.setLabel(void 0!==e.title?e.title:this.constructor.static.title),this.message.setLabel(void 0!==e.message?e.message:this.constructor.static.message),this.size=void 0!==e.size?e.size:this.constructor.static.size},this)},t.ui.MessageDialog.prototype.getReadyProcess=function(e){return e=e||{},t.ui.MessageDialog.parent.prototype.getReadyProcess.call(this,e).next(function(){var t=this.actions.get();(t=t.filter(function(t){return t.getFlags().indexOf("primary")>-1})).length>0&&t[0].focus()},this)},t.ui.MessageDialog.prototype.getBodyHeight=function(){var e,i,o=this.container.$element;return i=o[0].style.overflow,o[0].style.overflow="hidden",t.ui.Element.static.reconsiderScrollbars(o[0]),e=this.text.$element.outerHeight(!0),o[0].style.overflow=i,e},t.ui.MessageDialog.prototype.setDimensions=function(e){var i=this.container.$element;return t.ui.MessageDialog.parent.prototype.setDimensions.call(this,e),setTimeout(function(){var e=i[0].style.overflow,o=document.activeElement;i[0].style.overflow="hidden",t.ui.Element.static.reconsiderScrollbars(i[0]),o&&o!==document.activeElement&&o.focus&&o.focus(),i[0].style.overflow=e},300),this},t.ui.MessageDialog.prototype.initialize=function(){t.ui.MessageDialog.parent.prototype.initialize.call(this),this.$actions=$("<div>"),this.container=new t.ui.PanelLayout({scrollable:!0,classes:["oo-ui-messageDialog-container"]}),this.text=new t.ui.PanelLayout({padded:!0,expanded:!1,classes:["oo-ui-messageDialog-text"]}),this.message=new t.ui.LabelWidget({classes:["oo-ui-messageDialog-message"]}),this.title.$element.addClass("oo-ui-messageDialog-title"),this.$content.addClass("oo-ui-messageDialog-content"),this.container.$element.append(this.text.$element),this.text.$element.append(this.title.$element,this.message.$element),this.$body.append(this.container.$element),this.$actions.addClass("oo-ui-messageDialog-actions"),this.$foot.append(this.$actions)},t.ui.MessageDialog.prototype.attachActions=function(){var e,i,o,n,s;if(t.ui.MessageDialog.parent.prototype.attachActions.call(this),n=this.actions.getSpecial(),s=this.actions.getOthers(),n.safe&&(this.$actions.append(n.safe.$element),n.safe.toggleFramed(!1)),s.length)for(e=0,i=s.length;e<i;e++)o=s[e],this.$actions.append(o.$element),o.toggleFramed(!1);n.primary&&(this.$actions.append(n.primary.$element),n.primary.toggleFramed(!1)),this.isOpening()||this.updateSize()},t.ui.MessageDialog.prototype.fitActions=function(){var t,e,i,o=this.verticalActionLayout,n=this.actions.get();for(this.toggleVerticalActionLayout(!1),t=0,e=n.length;t<e;t++)if((i=n[t]).$element.innerWidth()<i.$label.outerWidth(!0)){this.toggleVerticalActionLayout(!0);break}this.$body.css("bottom",this.$foot.outerHeight(!0)),this.verticalActionLayout!==o&&this.updateSize()},t.ui.ProcessDialog=function(e){t.ui.ProcessDialog.parent.call(this,e),this.fitOnOpen=!1,this.$element.addClass("oo-ui-processDialog")},t.inheritClass(t.ui.ProcessDialog,t.ui.Dialog),t.ui.ProcessDialog.prototype.onDismissErrorButtonClick=function(){this.hideErrors()},t.ui.ProcessDialog.prototype.onRetryButtonClick=function(){this.hideErrors(),this.executeAction(this.currentAction)},t.ui.ProcessDialog.prototype.initialize=function(){t.ui.ProcessDialog.parent.prototype.initialize.call(this),this.$navigation=$("<div>"),this.$location=$("<div>"),this.$safeActions=$("<div>"),this.$primaryActions=$("<div>"),this.$otherActions=$("<div>"),this.dismissButton=new t.ui.ButtonWidget({label:t.ui.msg("ooui-dialog-process-dismiss")}),this.retryButton=new t.ui.ButtonWidget,this.$errors=$("<div>"),this.$errorsTitle=$("<div>"),this.dismissButton.connect(this,{click:"onDismissErrorButtonClick"}),this.retryButton.connect(this,{click:"onRetryButtonClick"}),this.title.$element.addClass("oo-ui-processDialog-title"),this.$location.append(this.title.$element).addClass("oo-ui-processDialog-location"),this.$safeActions.addClass("oo-ui-processDialog-actions-safe"),this.$primaryActions.addClass("oo-ui-processDialog-actions-primary"),this.$otherActions.addClass("oo-ui-processDialog-actions-other"),this.$errorsTitle.addClass("oo-ui-processDialog-errors-title").text(t.ui.msg("ooui-dialog-process-error")),this.$errors.addClass("oo-ui-processDialog-errors oo-ui-element-hidden").append(this.$errorsTitle,this.dismissButton.$element,this.retryButton.$element),this.$content.addClass("oo-ui-processDialog-content").append(this.$errors),this.$navigation.addClass("oo-ui-processDialog-navigation").append(this.$primaryActions,this.$location,this.$safeActions),this.$head.append(this.$navigation),this.$foot.append(this.$otherActions)},t.ui.ProcessDialog.prototype.getActionWidgets=function(e){var i,o,n,s=t.ui.isMobile(),r=[];for(i=0,o=e.length;i<o;i++)n=$.extend({framed:!t.ui.isMobile()},e[i]),s&&("back"===n.flags||Array.isArray(n.flags)&&-1!==n.flags.indexOf("back"))&&$.extend(n,{icon:"previous",label:""}),r.push(new t.ui.ActionWidget(n));return r},t.ui.ProcessDialog.prototype.attachActions=function(){var e,i,o,n,s;for(t.ui.ProcessDialog.parent.prototype.attachActions.call(this),n=this.actions.getSpecial(),s=this.actions.getOthers(),n.primary&&this.$primaryActions.append(n.primary.$element),e=0,i=s.length;e<i;e++)o=s[e],this.$otherActions.append(o.$element);n.safe&&this.$safeActions.append(n.safe.$element),this.fitLabel(),this.$body.css("bottom",this.$foot.outerHeight(!0))},t.ui.ProcessDialog.prototype.executeAction=function(e){var i=this;return t.ui.ProcessDialog.parent.prototype.executeAction.call(this,e).fail(function(t){i.showErrors(t||[])})},t.ui.ProcessDialog.prototype.setDimensions=function(){t.ui.ProcessDialog.parent.prototype.setDimensions.apply(this,arguments),this.fitLabel()},t.ui.ProcessDialog.prototype.fitLabel=function(){var t,e,i,o,n,s,r,a=this.getSizeProperties();if("number"!=typeof a.width){if(!this.isOpened())return this.isOpening()?void(this.fitOnOpen||(this.manager.lifecycle.opened.done(this.fitLabel.bind(this)),this.fitOnOpen=!0)):void 0;n=this.$head.width()-20}else n=a.width-20;return t=this.$safeActions.is(":visible")?this.$safeActions.width():0,e=this.$primaryActions.is(":visible")?this.$primaryActions.width():0,i=Math.max(t,e),o=this.title.$element.width(),2*i+o<n?s=r=i:"ltr"===this.getDir()?(s=t,r=e):(s=e,r=t),this.$location.css({paddingLeft:s,paddingRight:r}),this},t.ui.ProcessDialog.prototype.showErrors=function(e){var i,o,n,s,r=[],a={},c=!0,l=!1;for(e instanceof t.ui.Error&&(e=[e]),i=0,o=e.length;i<o;i++)e[i].isRecoverable()||(c=!1),e[i].isWarning()&&(l=!0),n=$("<div>").addClass("oo-ui-processDialog-error").append(e[i].getMessage()),r.push(n[0]);this.$errorItems=$(r),c?(a[this.currentAction]=!0,(s=this.actions.get({actions:this.currentAction})).length&&this.retryButton.clearFlags().setFlags(s[0].getFlags())):(a[this.currentAction]=!1,this.actions.setAbilities(a)),l?this.retryButton.setLabel(t.ui.msg("ooui-dialog-process-continue")):this.retryButton.setLabel(t.ui.msg("ooui-dialog-process-retry")),this.retryButton.toggle(c),this.$errorsTitle.after(this.$errorItems),this.$errors.removeClass("oo-ui-element-hidden").scrollTop(0)},t.ui.ProcessDialog.prototype.hideErrors=function(){this.$errors.addClass("oo-ui-element-hidden"),this.$errorItems&&(this.$errorItems.remove(),this.$errorItems=null)},t.ui.ProcessDialog.prototype.getTeardownProcess=function(e){return t.ui.ProcessDialog.parent.prototype.getTeardownProcess.call(this,e).first(function(){this.hideErrors(),this.fitOnOpen=!1},this)},t.ui.getWindowManager=function(){return t.ui.windowManager||(t.ui.windowManager=new t.ui.WindowManager,$("body").append(t.ui.windowManager.$element),t.ui.windowManager.addWindows([new t.ui.MessageDialog])),t.ui.windowManager},t.ui.alert=function(e,i){return t.ui.getWindowManager().openWindow("message",$.extend({message:e,actions:[t.ui.MessageDialog.static.actions[0]]},i)).closed.then(function(){})},t.ui.confirm=function(e,i){return t.ui.getWindowManager().openWindow("message",$.extend({message:e},i)).closed.then(function(t){return!(!t||"accept"!==t.action)})},t.ui.prompt=function(e,i){var o,n=t.ui.getWindowManager(),s=new t.ui.TextInputWidget(i&&i.textInput||{}),r=new t.ui.FieldLayout(s,{align:"top",label:e});return(o=n.openWindow("message",$.extend({message:r.$element},i))).opened.then(function(){s.on("enter",function(){n.getCurrentWindow().close({action:"accept"})}),s.focus()}),o.closed.then(function(t){return t&&"accept"===t.action?s.getValue():null})}}(OO);
//# sourceMappingURL=oojs-ui-windows.min.js.map