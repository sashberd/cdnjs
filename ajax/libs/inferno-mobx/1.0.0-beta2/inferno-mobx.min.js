!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("./inferno-component"),require("invariant"),require("mobx"),require("./inferno-dom"),require("./inferno-create-class"),require("hoist-non-inferno-statics"),require("./inferno-create-element")):"function"==typeof define&&define.amd?define(["inferno-component","invariant","mobx","inferno-dom","inferno-create-class","hoist-non-inferno-statics","inferno-create-element"],t):e.InfernoMobx=t(e.Component,e.invariant,e.mobx,e.InfernoDOM,e.createClass,e.hoistStatics,e.createElement)}(this,function(e,t,n,o,r,i,s){"use strict";function a(e){var t=o.findDOMNode(e);t&&v&&v.set(t,e),b.emit({event:"render",renderTime:e.__$mobRenderEnd-e.__$mobRenderStart,totalTime:Date.now()-e.__$mobRenderStart,component:e,node:t})}function p(){t("undefined"!=typeof WeakMap,"[inferno-mobx] tracking components is not supported in this browser."),y||(y=!0)}function c(e,t){var n=r({displayName:"MobXStoreInjector",render:function(){var n=this,o={};for(var r in this.props)n.props.hasOwnProperty(r)&&(o[r]=n.props[r]);var i=e(this.context.mobxStores||{},o,this.context)||{};for(var a in i)o[a]=i[a];return o.ref=function(e){n.wrappedInstance=e},s(t,o,this.props.children)}});return n.contextTypes={mobxStores:function(){}},n.wrappedComponent=t,i(n,t),n}function u(e){var t=arguments;if("function"!=typeof e){for(var n=[],o=0;o<arguments.length;o++)n[o]=t[o];e=_(n)}return function(t){return c(e,t)}}function f(n,o){var i=this;if(void 0===o&&(o=null),t("string"!=typeof n,"Store names should be provided as array"),Array.isArray(n))return o?u.apply(null,n)(f(o)):function(e){return f(n,e)};var s=n;if(!("function"!=typeof s||s.prototype&&s.prototype.render||s.isReactClass||e.isPrototypeOf(s))){var a=r({displayName:s.displayName||s.name,propTypes:s.propTypes,contextTypes:s.contextTypes,getDefaultProps:function(){return s.defaultProps},render:function(){return s.call(i,i.props,i.context)}});return f(a)}t(s,'Please pass a valid component to "observer"');var p=s.prototype||s;return S.forEach(function(e){return d(p,e)}),p.shouldComponentUpdate||(p.shouldComponentUpdate=x.shouldComponentUpdate),s.isMobXReactObserver=!0,s}function d(e,t){var n=e[t],o=x[t];n?e[t]=function(){n.apply(this,arguments),o.apply(this,arguments)}:e[t]=o}e="default"in e?e.default:e,t="default"in t?t.default:t,o="default"in o?o.default:o,r="default"in r?r.default:r,i="default"in i?i.default:i,s="default"in s?s.default:s;var l={children:!0,key:!0,ref:!0},m=function(e){function t(t,n){e.call(this,t,n),this.contextTypes={mobxStores:function(){}},this.childContextTypes={mobxStores:function(){}},this.store=t.store}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){return this.props.children},t.prototype.getChildContext=function(){var e=this,t={},n=this.context.mobxStores;if(n)for(var o in n)t[o]=n[o];for(var r in this.props)l[r]||(t[r]=e.props[r]);return{mobxStores:t}},t}(e),h=function(){this.listeners=[]};h.prototype.on=function(e){var t=this;return this.listeners.push(e),function(){var n=t.listeners.indexOf(e);n!==-1&&t.listeners.splice(n,1)}},h.prototype.emit=function(e){this.listeners.forEach(function(t){return t(e)})};var y=!1,v=new WeakMap,b=new h,x={componentWillMount:function(){var t,o=this,r=this.displayName||this.name||this.constructor&&(this.constructor.displayName||this.constructor.name)||"<component>",i=this._reactInternalInstance&&this._reactInternalInstance._rootNodeID,s=this.render.bind(this),a=!1,p=function(p,c){var u=function(){return s(p,c)},f=function(){a=!1;var e=void 0;return t.track(function(){y&&(o.__$mobRenderStart=Date.now()),e=n.extras.allowStateChanges(!1,u),y&&(o.__$mobRenderEnd=Date.now())}),e};return t=new n.Reaction(r+"#"+i+".render()",function(){a||(a=!0,"function"==typeof o.componentWillReact&&o.componentWillReact(),o.__$mobxIsUnmounted!==!0&&e.prototype.forceUpdate.call(o))}),f.$mobx=t,o.render=f,f()};this.render=p},componentWillUnmount:function(){if(this.render.$mobx&&this.render.$mobx.dispose(),this.__$mobxIsUnmounted=!0,y){var e=o.findDOMNode(this);e&&v&&v.delete(e),b.emit({event:"destroy",component:this,node:e})}},componentDidMount:function(){y&&a(this)},componentDidUpdate:function(){y&&a(this)},shouldComponentUpdate:function(e,t){var o=this;if(this.render.$mobx&&this.render.$mobx.isScheduled()===!0)return!1;if(this.state!==t)return!0;var r=Object.keys(this.props);if(r.length!==Object.keys(e).length)return!0;for(var i=r.length-1;i>=0;i--){var s=r[i],a=e[s];if(a!==o.props[s])return!0;if(a&&"object"==typeof a&&!n.isObservable(a))return!0}return!1}},_=function(e){return function(t,n){return e.forEach(function(e){if(!(e in n)){if(!(e in t))throw new Error('MobX observer: Store "'+e+'" is not available! Make sure it is provided by some Provider');n[e]=t[e]}}),n}},S=["componentWillMount","componentWillUnmount","componentDidMount","componentDidUpdate"],M={Provider:m,connect:f,observer:f,trackComponents:p,renderReporter:b,componentByNodeRegistery:v};return M});
