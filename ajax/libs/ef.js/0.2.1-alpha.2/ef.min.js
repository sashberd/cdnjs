!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ef=t()}(this,function(){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(t){!function(e,n){"function"==typeof define&&define.amd?define(n):"object"==typeof t&&t.exports?t.exports=n():e.log=n()}(e,function(){function e(e){return typeof console!==s&&(void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):i)}function t(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function n(e,t,n){return function(){typeof console!==s&&(r.call(this,t,n),this[e].apply(this,arguments))}}function r(e,t){for(var n=this,r=0;r<l.length;r++){var a=l[r];n[a]=r<e?i:n.methodFactory(a,e,t)}}function a(t,r,a){return e(t)||n.apply(this,arguments)}function o(e,t,n){function o(e){var t=(l[e]||"silent").toUpperCase();try{return void(window.localStorage[f]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"="+t+";"}catch(e){}}function i(){var e;try{e=window.localStorage[f]}catch(e){}if(typeof e===s)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(f)+"=");n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===c.levels[e]&&(e=void 0),e}var u,c=this,f="loglevel";e&&(f+=":"+e),c.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},c.methodFactory=n||a,c.getLevel=function(){return u},c.setLevel=function(t,n){if("string"==typeof t&&void 0!==c.levels[t.toUpperCase()]&&(t=c.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=c.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(u=t,n!==!1&&o(t),r.call(c,t,e),typeof console===s&&t<c.levels.SILENT)return"No console available for logging"},c.setDefaultLevel=function(e){i()||c.setLevel(e,!1)},c.enableAll=function(e){c.setLevel(c.levels.TRACE,e)},c.disableAll=function(e){c.setLevel(c.levels.SILENT,e)};var d=i();null==d&&(d=null==t?"WARN":t),c.setLevel(d,!1)}var i=function(){},s="undefined",l=["trace","debug","info","warn","error"],u=new o,c={};u.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=c[e];return t||(t=c[e]=new o(e,u.getLevel(),u.methodFactory)),t};var f=typeof window!==s?window.log:void 0;return u.noConflict=function(){return typeof window!==s&&window.log===u&&(window.log=f),u},u})}),n="[EF]",r=t.getLogger("ef"),a=(r.trace.bind(null,n),r.debug.bind(null,n),r.info.bind(null,n)),o=r.warn.bind(null,n),i=r.error.bind(null,n),s=function(e){return i("Detach the component before attaching it to a new component! Component to be detached:",e)},l=function(){return i("Cannot mount a component to it's child component!")};r.setLevel("error"),a("Debug logging enabled!");var u=new RegExp("\\&[0-7]{1,3}","g"),c=new RegExp("\\&u\\[.*?\\]","g"),f=new RegExp("\\&u.{0,4}","g"),d=new RegExp("\\&x.{0,2}","g"),p=new RegExp("\\&","g"),h=new RegExp("\\&b","g"),v=new RegExp("\\&t","g"),b=new RegExp("\\&n","g"),g=new RegExp("\\&v","g"),m=new RegExp("\\&f","g"),y=new RegExp("\\&r","g"),w=function(){throw new SyntaxError("Octal escape sequences are not allowed in EFML.")},N=function(e){if(e=e.substr(3,e.length-4),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");try{return String.fromCodePoint(e)}catch(e){throw new SyntaxError("Undefined Unicode code-point")}},x=function(e){if(e=e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");return String.fromCharCode(e)},$=function(e){if(e="00"+e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid hexadecimal escape sequence");return String.fromCharCode(e)},E=function(e){for(var t=e.split("&&"),n=[],r=0,a=t;r<a.length;r+=1){var o=a[r],i=o.replace(u,w).replace(c,N).replace(f,x).replace(d,$).replace(h,"\b").replace(v,"\t").replace(b,"\n").replace(g,"\v").replace(m,"\f").replace(y,"\r").replace(p,"");n.push(i)}return n.join("&")},D=E,k=">#%@.-+".split(""),T="attached data element refs methods subscribe unsubscribe update destroy".split(" ").map(function(e){return"$"+e}),R=function(e,t){return void 0===t&&(t=-2),"Failed to parse eft template: "+e+". at line "+(t+1)},S=function(e){return!e.replace(/\s/,"")},j=function(e,t){null===t.offset&&(t.offset=e.match(/\s*/)[0],t.offset&&(t.offsetReg=new RegExp("^"+t.offset)))},O=function(e,t,n){if(t.offsetReg){var r=!1;if(e=e.replace(t.offsetReg,function(){return r=!0,""}),!r)throw new SyntaxError(R("Expected indent to be grater than 0 and less than "+(t.prevDepth+1)+", but got -1",n))}return e},C=function(e,t){if(!t.indentReg){var n=e.match(/^(\t*)( *).*/)[2];n&&(t.indentReg=new RegExp(n))}},_=function(e,t,n){var r=0;t.indentReg&&(e=e.replace(/^\s*/,function(e){return e.replace(t.indentReg,"\t")}));var a=e.replace(/^\t*/,function(e){return r=e.length,""});if(/^\s/.test(a))throw new SyntaxError(R("Bad indent",n));return{depth:r,content:a}},L=function(e,t){for(var n=e,r=0;r<t;r++)n=n[n.length-1];return n},A=function(e){e=e.slice(2,e.length-2);var t=e.split("="),n=t[0],r=t.slice(1),a=n.trim().split("."),o=D(r.join("=").trim());return o?[a,o]:[a]},I=function(e){var t=e.split(/\{\{.+?\}\}/g);if(1===t.length)return D(e);var n=[t.map(D)],r=e.match(/\{\{.+?\}\}/g);return r&&n.push.apply(n,r.map(A)),n},P=function(e,t){t&&e.push(t)},F=function(e){for(var t=I(e),n=t[0],r=t.slice(1),a=[],o=0;o<r.length;o++)P(a,n[o]),a.push(r[o]);return P(a,n[n.length-1]),a},U=function(e){return e.replace(/\./g," ")},q=function(e){var t={},n=e.replace(/#([^}]|}[^}])*$/,function(e){return t.ref=e.slice(1),""}).split("."),r=n[0],a=n.slice(1);return t.tag=r,t.class=I(a.join(".")),"string"==typeof t.class?t.class=U(t.class).trim():t.class[0]=t.class[0].map(U),t},B=function(e){var t=e.split("=");return{name:t.shift().trim(),value:I(t.join("=").trim())}},K=function(e){var t=e.split("=");return{name:t.shift().trim(),value:t.join("=").trim()}},M=function(e,t){switch(t){case"stop":e.s=1;break;case"stopImmediate":e.i=1;break;case"prevent":e.p=1;break;case"shift":e.h=1;break;case"alt":e.a=1;break;case"ctrl":e.c=1;break;case"meta":e.t=1;break;case"capture":e.u=1;break;default:console.warn("Abandoned unsupported event option '"+t+"'.")}},W=function(e,t,n){var r=parseInt(n,10);if(isNaN(r))return M(e,n);t.push(r)},z=function(e){var t={},n=[],r=e.split("."),a=r[0],o=r.slice(1);t.l=a;for(var i=0,s=o;i<s.length;i+=1){W(t,n,s[i])}return n.length>0&&(t.k=n),t},G=function(e){var t=e.split(":"),n=t[0],r=t.slice(1),a=r.join(":");return a?[n.trim(),I(a)]:[n.trim()]},Y=function(e){var t=e.line,n=e.ast,r=e.parsingInfo,a=e.i;if(!S(t)){C(t,r),j(t,r);var o=_(O(t,r,a),r,a),i=o.depth,s=o.content;if(s){if(i<0||i-r.prevDepth>1||i-r.prevDepth==1&&["comment","tag"].indexOf(r.prevType)===-1||"comment"!==r.prevType&&0===i&&r.topExists)throw new SyntaxError(R("Expected indent to be grater than 0 and less than "+(r.prevDepth+1)+", but got "+i,a));var l=s[0];if(s=s.slice(1),!r.topExists&&k.indexOf(l)>=0&&">"!==l)throw new SyntaxError(R("No top level entry",a));if(!s&&k.indexOf(l)>=0)throw new SyntaxError(R("Empty content",a));switch((i<r.prevDepth||i===r.prevDepth&&"tag"===r.prevType)&&(r.currentNode=L(n,i)),r.prevDepth=i,l){case">":r.topExists||(r.topExists=!0,r.minDepth=i);var u=q(s),c=[{t:u.tag}];u.class&&(c[0].a={},c[0].a.class=u.class),u.ref&&(c[0].r=u.ref),r.currentNode.push(c),r.currentNode=c,r.prevType="tag";break;case"#":var f=B(s),d=f.name,p=f.value;r.currentNode[0].a||(r.currentNode[0].a={}),r.currentNode[0].a[d]=p,r.prevType="attr";break;case"%":var h=B(s),v=h.name,b=h.value;r.currentNode[0].p||(r.currentNode[0].p={}),r.currentNode[0].p[v]=b,r.prevType="prop";break;case"@":var g=K(s),m=g.name,y=g.value;r.currentNode[0].e||(r.currentNode[0].e=[]);var w=z(m),N=G(y),x=N[0],$=N[1];w.m=x,$&&(w.v=$),r.currentNode[0].e.push(w),r.prevType="event";break;case".":(E=r.currentNode).push.apply(E,F(s)),r.prevType="text";break;case"-":if(T.indexOf(s)!==-1)throw new SyntaxError(R("Reserved name '"+s+"' should not be used",a));r.currentNode.push({n:s,t:0}),r.prevType="node";break;case"+":r.currentNode.push({n:s,t:1}),r.prevType="list";break;default:r.prevType="comment"}}var E}},H=function(e){if(!e)throw new TypeError(R("Template required, but nothing present"));var t=typeof e;if("string"!==t)throw new TypeError(R("Expected a string, but got a(n) "+t));for(var n=e.split(/\r?\n/),r=[],a={indentReg:null,prevDepth:0,offset:null,offsetReg:null,prevType:"comment",currentNode:r,topExists:!1},o=0;o<n.length;o++)Y({line:n[o],ast:r,parsingInfo:a,i:o});if(r[0])return r[0];throw new SyntaxError(R("Nothing to be parsed",n.length-1))},J=function(e,t){return t||(t=H),t(e)},Q=Array.prototype,V={copy:function(e){return Q.slice.call(e,0)},empty:function(e){return e.length=0,e},equals:function(e,t){if(!Array.isArray(t))return!1;if(e===t)return!0;if(e.length!==t.length)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0},pop:function(e){return Q.pop.call(e)},push:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return Q.push.apply(e,t)},remove:function(e,t){var n=Q.indexOf.call(e,t);if(n>-1)return Q.splice.call(e,n,1),t},reverse:function(e){return Q.reverse.call(e)},shift:function(e){return Q.shift.call(e)},slice:function(e,t,n){return Q.slice.call(e,t,n)},sort:function(e,t){return Q.sort.call(e,t)},splice:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return Q.splice.apply(e,t)},unique:function(e){for(var t=[],n=0;n<e.length;n++){for(var r=n+1;r<e.length;r++)e[n]===e[r]&&(r=n+=1);t.push(e[n])}return t},unshift:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];return Q.unshift.apply(e,t)}};window.Set&&(V.unique=function(e){return Array.from(new Set(e))});var X=function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];for(var r="",a=0;a<t.length;a++)r+=e[a]+t[a];return r+e[e.length-1]},Z=function(e){return e.dataNode[e._key]},ee=function(e){var t=e[0],n=e.slice(1),r=[t];return r.push.apply(r,n.map(Z)),X.apply(void 0,r)},te=function(e,t){for(var n in t)e[n]=t[n];return e},ne=Object.assign||te,re=[],ae=0,oe=function(e){return re.push.apply(re,e)},ie=function(){return ae+=1},se=function(e){if(!e&&(ae-=1)>0)return ae;ae=0;for(var t=V.unique(re),n=0,r=t;n<r.length;n+=1){(0,r[n])()}return V.empty(re),ae},le=function(e){for(var t=e._path,n=e.handlers,r=e.subscribers,a=e.innerData,o=0,i=t;o<i.length;o+=1){var s=i[o];n[s]||(n[s]={}),r[s]||(r[s]={}),a[s]||(a[s]={}),n=n[s],r=r[s],a=a[s]}return{handlerNode:n,subscriberNode:r,dataNode:a}},ue=function(e,t,n){for(var r=0,a=e;r<a.length;r+=1){var o=a[r];if(!t[o]){var i={};Object.defineProperty(t,o,{get:function(){return i},set:function(e){ie(),ne(i,e),se()},configurable:!n,enumerable:n})}t=t[o]}return t},ce=function(e){var t=e._path,n=e._key,r=e.data,a=e.handlers,o=e.subscribers,i=e.innerData,s=ue(t,r,!0),l=le({_path:t,handlers:a,subscribers:o,innerData:i}),u=l.handlerNode,c=l.subscriberNode,f=l.dataNode;return u[n]||(u[n]=[]),c[n]||(c[n]=[]),Object.prototype.hasOwnProperty.call(f,n)||(f[n]=""),{parentNode:s,handlerNode:u[n],subscriberNode:c[n],dataNode:f}},fe=function(e,t){for(var n=e.split("."),r=n.pop(),a=0,o=n;a<o.length;a+=1){var i=o[a];t[i]||(t[i]={}),t=t[i]}return t[r]},de=function(e){var t=e.parentNode,n=e.dataNode,r=e.handlerNode,a=e.subscriberNode,o=e.state,i=e._key;Object.defineProperty(t,i,{get:function(){return n[i]},set:function(e){if(n[i]!==e){n[i]=e,oe(r),ie();for(var t=0,s=a;t<s.length;t+=1){(0,s[t])({state:o,value:e})}se()}},enumerable:!0})},pe=function(e){var t=e.bind,n=e.state,r=e.handlers,a=e.subscribers,o=e.innerData,i=V.copy(t[0]),s=t[1],l=i.pop(),u=ce({_path:i,_key:l,data:n.$data,handlers:r,subscribers:a,innerData:o}),c=u.parentNode,f=u.handlerNode,d=u.subscriberNode,p=u.dataNode;return Object.prototype.hasOwnProperty.call(c,l)||de({parentNode:c,dataNode:p,handlerNode:f,subscriberNode:d,state:n,_key:l}),s&&(c[l]=s),{dataNode:p,handlerNode:f,subscriberNode:d,_key:l}},he=function(e,t,n){var r=document.createElement(e);return t&&Object.defineProperty(n,t,{value:r,enumerable:!0}),r},ve=function(e){var t=e.val,n=e.state,r=e.handlers,a=e.subscribers,o=e.innerData,i=e.handler;if(Array.isArray(t)){var s=t[0],l=t.slice(1),u=[s],c=function(){return i(ee(u))};return u.push.apply(u,l.map(function(e){var t=pe({bind:e,state:n,handlers:r,subscribers:a,innerData:o}),i=t.dataNode,s=t.handlerNode,l=t._key;return s.push(c),{dataNode:i,_key:l}})),c}return function(){return t}},be=function(e){var t=e.dataNode,n=e.handlerNode,r=e.subscriberNode,a=e._handler,o=e.state,i=e._key,s=e.value;if(t[i]!==s){t[i]=s;var l=V.copy(n);V.remove(l,a),oe(l),ie();for(var u=0,c=r;u<c.length;u+=1){(0,c[u])({state:o,value:s})}se()}},ge=function(e){var t=e._handler,n=e.state,r=e.handlers,a=e.subscribers,o=e.innerData,i=e.element,s=e.key,l=e.expr,u=pe({bind:l,state:n,handlers:r,subscribers:a,innerData:o}),c=u.dataNode,f=u.handlerNode,d=u.subscriberNode,p=u._key,h=function(){return be({dataNode:c,handlerNode:f,subscriberNode:d,_handler:t,state:n,_key:p,value:i.value})};"value"===s?(i.addEventListener("input",h,!0),i.addEventListener("keyup",h,!0),i.addEventListener("change",h,!0)):i.addEventListener("change",function(){return be({dataNode:c,handlerNode:f,subscriberNode:d,_handler:t,state:n,_key:p,value:i.checked})},!0)},me=function(e,t){return"class"===t?function(n){n=n.replace(/\s+/g," ").trim(),e.setAttribute(t,n)}:function(n){return e.setAttribute(t,n)}},ye=function(e){var t=e.element,n=e.attr,r=e.key,a=e.state,o=e.handlers,i=e.subscribers,s=e.innerData;if("string"==typeof n)t.setAttribute(r,n);else{oe([ve({val:n,state:a,handlers:o,subscribers:i,innerData:s,handler:me(t,r)})])}},we=function(e){var t=e.element,n=e.prop,r=e.key,a=e.state,o=e.handlers,i=e.subscribers,s=e.innerData;if("string"==typeof n)t[r]=n;else{var l=function(e){t[r]=e},u=ve({val:n,state:a,handlers:o,subscribers:i,innerData:s,handler:l});"value"!==r&&"checked"!==r||""!==n[0][0]||""!==n[0][1]||2!==n.length||ge({_handler:u,state:a,handlers:o,subscribers:i,innerData:s,element:t,key:r,expr:n[1]}),oe([u])}},Ne=function(e){return e},xe=function(e){var t=e.element,n=e.event,r=e.state,a=e.handlers,i=e.subscribers,s=e.innerData,l=n.l,u=n.m,c=n.s,f=n.i,d=n.p,p=n.h,h=n.a,v=n.c,b=n.t,g=n.u,m=n.k,y=n.v,w=ve({val:y,state:r,handlers:a,subscribers:i,innerData:s,handler:Ne});t.addEventListener(l,function(e){!!p!=!!e.shiftKey||!!h!=!!e.altKey||!!v!=!!e.ctrlKey||!!b!=!!e.metaKey||m&&m.indexOf(e.which)===-1||(c&&e.stopPropagation(),f&&e.stopImmediatePropagation(),d&&e.preventDefault(),r.$methods[u]?r.$methods[u]({e:e,value:w(),state:r}):o("Method named '"+u+"' not found!"))},!!g)},$e=function(e){var t=e.info,n=e.state,r=e.innerData,a=e.refs,o=e.handlers,i=e.subscribers,s=t.t,l=t.a,u=t.p,c=t.e,f=t.r,d=he(s,f,a);for(var p in l)ye({element:d,attr:l[p],key:p,state:n,handlers:o,subscribers:i,innerData:r});for(var h in u)we({element:d,prop:u[h],key:h,state:n,handlers:o,subscribers:i,innerData:r});for(var v in c)xe({element:d,event:c[v],state:n,handlers:o,subscribers:i,innerData:r});return d},Ee=Node.prototype,De={before:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];var r=document.createDocumentFragment();t.reverse();for(var a=0,o=t;a<o.length;a+=1){var i=o[a];Ee.appendChild.call(r,i)}Ee.insertBefore.call(e.parentNode,r,e)},after:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];for(var r=document.createDocumentFragment(),a=0,o=t;a<o.length;a+=1){var i=o[a];Ee.appendChild.call(r,i)}e.nextSibling?Ee.insertBefore.call(e.parentNode,r,e.nextSibling):Ee.appendChild.call(e.parentNode,r)},append:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if([1,9,11].indexOf(e.nodeType)!==-1){for(var r=document.createDocumentFragment(),a=0,o=t;a<o.length;a+=1){var i=o[a];Ee.appendChild.call(r,i)}Ee.appendChild.call(e,r)}},remove:function(e){Ee.removeChild.call(e.parentNode,e)}},ke={empty:function(){for(var e=this,t=0,n=e;t<n.length;t+=1){var r=n[t];De.remove(r.$element),r.$destroy()}V.empty(this)},pop:function(){if(0!==this.length){var e=V.pop(this);return De.remove(e.$element),e}},push:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];for(var r=[],a=0,o=t;a<o.length;a+=1){var i=o[a];V.push(r,i.$element)}return 0===this.length?De.after.apply(De,[e].concat(r)):De.after.apply(De,[this[this.length-1].$element].concat(r)),V.push.apply(V,[this].concat(t))},remove:function(){for(var e=this,t=[],n=arguments.length;n--;)t[n]=arguments[n];for(var r=[],a=0,o=t;a<o.length;a+=1){var i=o[a],s=V.remove(e,i);s&&(De.remove(s.$element),V.push(r,s))}return r},reverse:function(){var e=this;if(0===this.length)return this;var t=document.createTextNode("");De.before(this[0].$element,t);for(var n=[],r=this.length-1;r>=0;r--)V.push(n,e[r].$element);return De.after.apply(De,[t].concat(n)),De.remove(t),V.reverse(this)},shift:function(){if(0!==this.length){var e=V.shift(this);return De.remove(e.$element),e}},sort:function(e){var t=this;if(0===this.length)return this;var n=document.createTextNode("");De.before(this[0].$element,n);for(var r=V.sort(this,e),a=[],o=0,i=t;o<i.length;o+=1){var s=i[o];V.push(a,s.$element)}return De.after.apply(De,[n].concat(a)),De.remove(n),r},splice:function(){for(var e=this,t=[],n=arguments.length;n--;)t[n]=arguments[n];if(0===this.length)return this;var r=document.createTextNode("");De.before(this[0].$element,r);for(var a=V.splice.apply(V,[this].concat(t)),o=[],i=0,s=a;i<s.length;i+=1){var l=s[i];De.remove(l.$element)}for(var u=0,c=e;u<c.length;u+=1){var f=c[u];V.push(o,f.$element)}return De.after.apply(De,[r].concat(o)),De.remove(r),a},unshift:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(0===this.length)return(l=this).push.apply(l,e).length;var n=document.createTextNode("");De.before(this[0].$element,n);for(var r=[],a=0,o=e;a<o.length;a+=1){var i=o[a];if(i.$attached)return s(i);V.push(r,i.$element)}return De.after.apply(De,[n].concat(r)),De.remove(n),V.unshift.apply(V,[this].concat(e));var l}},Te=function(e,t){return Object.defineProperties(e,{empty:{value:ke.empty},pop:{value:ke.pop},push:{value:ke.push.bind(e,t)},remove:{value:ke.remove},reverse:{value:ke.reverse},shift:{value:ke.shift},sort:{value:ke.sort},splice:{value:ke.splice},unshift:{value:ke.unshift}}),e},Re=function(e){return Array.isArray(e)?"array":typeof e},Se=function(e){var t=e.node,n=e.state,r=e.handlers,a=e.subscribers,o=e.innerData,i=e.element,s=document.createTextNode(""),l=pe({bind:t,state:n,handlers:r,subscribers:a,innerData:o}),u=l.dataNode,c=l.handlerNode,f=l._key,d=function(){s.textContent=u[f]};c.push(d),oe([d]),De.append(i,s)},je=function(e){var t=e.$element,n=e.children,r=e.name,a=e.anchor,o=e.value;if(n[r]!==o){if(o&&(o.$attached&&s(o),o.$element.contains(t)))return l();n[r]&&De.remove(n[r].$element),o&&De.after(a,o.$element),n[r]=o}},Oe=function(e){var t=e.state,n=e.name,r=e.children,a=e.anchor;Object.defineProperty(t,n,{get:function(){return r[n]},set:function(e){je({$element:t.$element,children:r,name:n,anchor:a,value:e})},enumerable:!0,configurable:!0})},Ce=function(e){var t=e.$element,n=e.children,r=e.name,a=e.anchor,o=e.value;o=o?V.copy(o):[];var i=document.createDocumentFragment();if(n[r]){for(var s=0,u=o;s<u.length;s+=1){var c=u[s];if(c.$element.contains(t))return l();De.append(i,c.$element),V.remove(n[r],c)}for(var f=0,d=n[r];f<d.length;f+=1){var p=d[f];De.remove(p.$element)}}else for(var h=0,v=o;h<v.length;h+=1){var b=v[h];De.append(i,b.$element)}n[r].length=0,V.push.apply(V,[n[r]].concat(o)),De.after(a,i)},_e=function(e){var t=e.state,n=e.name,r=e.children,a=e.anchor;r[n]=Te([],a),Object.defineProperty(t,n,{get:function(){return r[n]},set:function(e){r[n]&&V.equals(r[n],e)||Ce({$element:t.$element,children:r,name:n,anchor:a,value:e})},enumerable:!0,configurable:!0})},Le=function(e){var t=e.node,n=e.nodeType,r=e.element,a=e.state,o=e.innerData,i=e.refs,s=e.children,l=e.handlers,u=e.subscribers,c=e.create;switch(n){case"string":De.append(r,document.createTextNode(t));break;case"array":"object"===Re(t[0])?De.append(r,c({ast:t,state:a,innerData:o,refs:i,children:s,handlers:l,subscribers:u,create:c})):Se({node:t,state:a,handlers:l,subscribers:u,innerData:o,element:r});break;case"object":var f=document.createTextNode("");if(0===t.t)Oe({state:a,name:t.n,children:s,anchor:f});else{if(1!==t.t)throw new TypeError("Not a standard ef.js AST: Unknown mounting point type '"+t.t+"'");_e({state:a,name:t.n,children:s,anchor:f})}De.append(r,f);break;default:throw new TypeError("Not a standard ef.js AST: Unknown node type '"+n+"'")}},Ae=function(e){for(var t=e.ast,n=e.state,r=e.innerData,a=e.refs,o=e.children,i=e.handlers,s=e.subscribers,l=e.create,u=$e({info:t[0],state:n,innerData:r,refs:a,handlers:i,subscribers:s}),c=1;c<t.length;c++)Le({node:t[c],nodeType:Re(t[c]),element:u,state:n,innerData:r,refs:a,children:o,handlers:i,subscribers:s,create:l});return u},Ie=function(e,t,n){var r=e.split("."),a=fe(r,n);V.remove(a,t)},Pe=function(){return!!this.$element.parentNode},Fe=function(e){var t=ne({},e);t.$data&&(ne(this.$data,t.$data),delete t.$data),t.$methods&&(ne(this.$methods,t.$methods),delete t.$methods),ne(this,t)},Ue=function(){var e=this;for(var t in e)e[t]=null,delete e[t];delete this.$element,delete this.$data,delete this.$methods,delete this.$refs,delete this.$subscribe,delete this.$unsubscribe,delete this.$attached,delete this.$update,delete this.$destroy},qe=function(e){var t={},n={},r={},a={},o={},i={},s={};return Object.defineProperties(t,{$methods:{get:function(){return o},set:function(e){ne(o,e)},configurable:!0},$refs:{value:r,configurable:!0},$subscribe:{value:function(e,n){var r=e.split("."),o=pe({bind:[r],state:t,handlers:i,subscribers:s,innerData:a}),l=o.dataNode,u=o.subscriberNode;n({state:t,value:l[o._key]}),u.push(n)},configurable:!0},$unsubscribe:{value:function(e,t){Ie(e,t,s)},configurable:!0},$attached:{get:Pe,configurable:!0},$update:{value:Fe,configurable:!0},$destroy:{value:Ue,configurable:!0}}),ue(["$data"],t,!1),Object.defineProperty(t,"$element",{value:Ae({ast:e,state:t,innerData:a,refs:r,children:n,handlers:i,subscribers:s,create:Ae}),configurable:!0}),t},Be=H,Ke=function(){function e(e){var t=Re(e);if("string"===t)e=J(e,Be);else if("array"!==t)throw new TypeError("Cannot create new component without proper template or AST!");var n=e;Object.defineProperty(this,"render",{value:function(e){ie();var t=qe(n);return e&&t.$update(e),se(),t}})}return e.inform=function(){return ie()},e.exec=function(e){return se(e)},e.setPatser=function(e){Be=e},e.parseEft=function(e){return H(e)},e.t=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return new e(X.apply(void 0,t))},e}();return a("ef.js v0.2.1-alpha.2 initialized!"),Ke});
