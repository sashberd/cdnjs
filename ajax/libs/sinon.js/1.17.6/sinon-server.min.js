function getGlobal(){return"undefined"!=typeof window?window:global}var sinon=function(){"use strict";function e(e,n,r){t=r.exports=e("./sinon/util/core"),e("./sinon/extend"),e("./sinon/walk"),e("./sinon/typeOf"),e("./sinon/times_in_words"),e("./sinon/spy"),e("./sinon/call"),e("./sinon/behavior"),e("./sinon/stub"),e("./sinon/mock"),e("./sinon/collection"),e("./sinon/assert"),e("./sinon/sandbox"),e("./sinon/test"),e("./sinon/test_case"),e("./sinon/match"),e("./sinon/format"),e("./sinon/log_error")}var t,n="undefined"!=typeof module&&module.exports&&"function"==typeof require;return"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(e):n?(e(require,module.exports,module),t=module.exports):t={},t}();!function(e){function t(e){var t=!1;try{e.appendChild(f),t=f.parentNode===e}catch(e){return!1}finally{try{e.removeChild(f)}catch(e){}}return t}function n(e){return f&&e&&1===e.nodeType&&t(e)}function r(e){return"function"==typeof e||!!(e&&e.constructor&&e.call&&e.apply)}function o(e){return"number"==typeof e&&isNaN(e)}function s(e,t){for(var n in t)c.call(e,n)||(e[n]=t[n])}function i(e){return"function"==typeof e&&"function"==typeof e.restore&&e.restore.sinon}function a(e){return e.wrapMethod=function(t,n,o){function i(e){var t;if(r(e)){if(e.restore&&e.restore.sinon)t=new TypeError("Attempted to wrap "+n+" which is already wrapped");else if(e.calledBefore){var o=e.returns?"stubbed":"spied on";t=new TypeError("Attempted to wrap "+n+" which is already "+o)}}else t=new TypeError("Attempted to wrap "+typeof e+" property "+n+" as function");if(t)throw e&&e.stackTrace&&(t.stack+="\n--------------\n"+e.stackTrace),t}function a(){i(f=t[n]),t[n]=o,o.displayName=n}if(!t)throw new TypeError("Should wrap property of object");if("function"!=typeof o&&"object"!=typeof o)throw new TypeError("Method wrapper should be a function or a property descriptor");var u,f,p,l=t.hasOwnProperty?t.hasOwnProperty(n):c.call(t,n);if(d){var h="function"==typeof o?{value:o}:o,y=e.getPropertyDescriptor(t,n);if(y?y.restore&&y.restore.sinon&&(u=new TypeError("Attempted to wrap "+n+" which is already wrapped")):u=new TypeError("Attempted to wrap "+typeof f+" property "+n+" as function"),u)throw y&&y.stackTrace&&(u.stack+="\n--------------\n"+y.stackTrace),u;var v=e.objectKeys(h);for(p=0;p<v.length;p++)i(f=y[v[p]]);for(s(h,y),p=0;p<v.length;p++)s(h[v[p]],y[v[p]]);Object.defineProperty(t,n,h),"function"==typeof o&&t[n]!==o&&(delete t[n],a())}else a();return o.displayName=n,o.stackTrace=new Error("Stack Trace for original").stack,o.restore=function(){if(l)d&&Object.defineProperty(t,n,y);else try{delete t[n]}catch(e){}t[n]===o&&(t[n]=f)},o.restore.sinon=!0,d||s(o,f),o},e.create=function(e){var t=function(){};return t.prototype=e,new t},e.deepEqual=function t(r,s){if(e.match&&e.match.isMatcher(r))return r.test(s);if("object"!=typeof r||"object"!=typeof s)return o(r)&&o(s)||r===s;if(n(r)||n(s))return r===s;if(r===s)return!0;if(null===r&&null!==s||null!==r&&null===s)return!1;if(r instanceof RegExp&&s instanceof RegExp)return r.source===s.source&&r.global===s.global&&r.ignoreCase===s.ignoreCase&&r.multiline===s.multiline;var i=Object.prototype.toString.call(r);if(i!==Object.prototype.toString.call(s))return!1;if("[object Date]"===i)return r.valueOf()===s.valueOf();var a,u=0,f=0;if("[object Array]"===i&&r.length!==s.length)return!1;for(a in r)if(c.call(r,a)){if(u+=1,!(a in s))return!1;if(!t(r[a],s[a]))return!1}for(a in s)c.call(s,a)&&(f+=1);return u===f},e.functionName=function(e){var t=e.displayName||e.name;if(!t){var n=e.toString().match(/function ([^\s\(]+)/);t=n&&n[1]}return t},e.functionToString=function(){if(this.getCall&&this.callCount)for(var e,t,n=this.callCount;n--;){e=this.getCall(n).thisValue;for(t in e)if(e[t]===this)return t}return this.displayName||"sinon fake"},e.objectKeys=function(e){if(e!==Object(e))throw new TypeError("sinon.objectKeys called on a non-object");var t,n=[];for(t in e)c.call(e,t)&&n.push(t);return n},e.getPropertyDescriptor=function(e,t){for(var n,r=e;r&&!(n=Object.getOwnPropertyDescriptor(r,t));)r=Object.getPrototypeOf(r);return n},e.getConfig=function(t){var n={};t=t||{};var r=e.defaultConfig;for(var o in r)r.hasOwnProperty(o)&&(n[o]=t.hasOwnProperty(o)?t[o]:r[o]);return n},e.defaultConfig={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},e.timesInWords=function(e){return 1===e&&"once"||2===e&&"twice"||3===e&&"thrice"||(e||0)+" times"},e.calledInOrder=function(e){for(var t=1,n=e.length;t<n;t++)if(!e[t-1].calledBefore(e[t])||!e[t].called)return!1;return!0},e.orderByFirstCall=function(e){return e.sort(function(e,t){var n=e.getCall(0),r=t.getCall(0);return(n&&n.callId||-1)<(r&&r.callId||-1)?-1:1})},e.createStubInstance=function(t){if("function"!=typeof t)throw new TypeError("The constructor should be a function.");return e.stub(e.create(t.prototype))},e.restore=function(e){if(null!==e&&"object"==typeof e)for(var t in e)i(e[t])&&e[t].restore();else i(e)&&e.restore()},e}function u(e,t){a(t)}var f="undefined"!=typeof document&&document.createElement("div"),c=Object.prototype.hasOwnProperty,d="keys"in Object,p="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(u):p?u(require,module.exports,module):e&&a(e)}("object"==typeof sinon&&sinon),function(e){function t(e){var t=function(){var e={constructor:function(){return"0"},toString:function(){return"1"},valueOf:function(){return"2"},toLocaleString:function(){return"3"},prototype:function(){return"4"},isPrototypeOf:function(){return"5"},propertyIsEnumerable:function(){return"6"},hasOwnProperty:function(){return"7"},length:function(){return"8"},unique:function(){return"9"}},t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]());return"0123456789"!==t.join("")}();return e.extend=function(e){var n,r,o,s=Array.prototype.slice.call(arguments,1);for(r=0;r<s.length;r++){n=s[r];for(o in n)n.hasOwnProperty(o)&&(e[o]=n[o]);t&&n.hasOwnProperty("toString")&&n.toString!==e.toString&&(e.toString=n.toString)}return e},e.extend}function n(e,n,r){var o=e("./util/core");r.exports=t(o)}var r="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(n):r?n(require,module.exports,module):e&&t(e)}("object"==typeof sinon&&sinon),void 0===sinon&&(this.sinon={}),function(){function e(e){e.Event=function(e,t,n,r){this.initEvent(e,t,n,r)},e.Event.prototype={initEvent:function(e,t,n,r){this.type=e,this.bubbles=t,this.cancelable=n,this.target=r},stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}},e.ProgressEvent=function(e,t,n){this.initEvent(e,!1,!1,n),this.loaded="number"==typeof t.loaded?t.loaded:null,this.total="number"==typeof t.total?t.total:null,this.lengthComputable=!!t.total},e.ProgressEvent.prototype=new e.Event,e.ProgressEvent.prototype.constructor=e.ProgressEvent,e.CustomEvent=function(e,t,n){this.initEvent(e,!1,!1,n),this.detail=t.detail||null},e.CustomEvent.prototype=new e.Event,e.CustomEvent.prototype.constructor=e.CustomEvent,e.EventTarget={addEventListener:function(e,t){this.eventListeners=this.eventListeners||{},this.eventListeners[e]=this.eventListeners[e]||[],n.call(this.eventListeners[e],t)},removeEventListener:function(e,t){for(var n=this.eventListeners&&this.eventListeners[e]||[],r=0,o=n.length;r<o;++r)if(n[r]===t)return n.splice(r,1)},dispatchEvent:function(e){for(var t=e.type,n=this.eventListeners&&this.eventListeners[t]||[],r=0;r<n.length;r++)"function"==typeof n[r]?n[r].call(this,e):n[r].handleEvent(e);return!!e.defaultPrevented}}}function t(t){e(t("./core"))}var n=[].push,r="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(t):r?t(require):e(sinon)}(),function(e){function t(e){function t(n,r){function o(){throw r.message=s+r.message,r}var s=n+" threw exception: ";e.log(s+"["+r.name+"] "+r.message),r.stack&&e.log(r.stack),t.useImmediateExceptions?o():t.setTimeout(o,0)}t.useImmediateExceptions=!1,t.setTimeout=function(e,t){r(e,t)};var n={};return n.log=e.log=function(){},n.logError=e.logError=t,n}function n(e,n,r){var o=e("./util/core");r.exports=t(o)}var r=setTimeout,o="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(n):o?n(require,module.exports,module):e&&t(e)}("object"==typeof sinon&&sinon),void 0===sinon&&(void 0===this?getGlobal().sinon={}:this.sinon={}),function(e){function t(t){function n(){this.readyState=n.UNSENT,this.requestBody=null,this.requestHeaders={},this.status=0,this.timeout=null,"function"==typeof n.onCreate&&n.onCreate(this)}function o(e){if(e.readyState!==n.OPENED)throw new Error("INVALID_STATE_ERR");if(e.sendFlag)throw new Error("INVALID_STATE_ERR")}function s(e){if(e.readyState===n.UNSENT)throw new Error("Request not sent");if(e.readyState===n.DONE)throw new Error("Request done")}function i(e){if("string"!=typeof e){var t=new Error("Attempted to respond to fake XDomainRequest with "+e+", which is not a string.");throw t.name="InvalidBodyException",t}}t.xdr=r,t.extend(n.prototype,t.EventTarget,{open:function(e,t){this.method=e,this.url=t,this.responseText=null,this.sendFlag=!1,this.readyStateChange(n.OPENED)},readyStateChange:function(e){this.readyState=e;var r="";switch(this.readyState){case n.UNSENT:case n.OPENED:break;case n.LOADING:this.sendFlag&&(r="onprogress");break;case n.DONE:r=this.isTimeout?"ontimeout":this.errorFlag||this.status<200||this.status>299?"onerror":"onload"}if(r&&"function"==typeof this[r])try{this[r]()}catch(e){t.logError("Fake XHR "+r+" handler",e)}},send:function(e){o(this),/^(get|head)$/i.test(this.method)||(this.requestBody=e),this.requestHeaders["Content-Type"]="text/plain;charset=utf-8",this.errorFlag=!1,this.sendFlag=!0,this.readyStateChange(n.OPENED),"function"==typeof this.onSend&&this.onSend(this)},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.readyState>t.FakeXDomainRequest.UNSENT&&this.sendFlag&&(this.readyStateChange(t.FakeXDomainRequest.DONE),this.sendFlag=!1)},setResponseBody:function(e){s(this),i(e);var t=this.chunkSize||10,r=0;this.responseText="";do{this.readyStateChange(n.LOADING),this.responseText+=e.substring(r,r+t),r+=t}while(r<e.length);this.readyStateChange(n.DONE)},respond:function(e,t,n){this.status="number"==typeof e?e:200,this.setResponseBody(n||"")},simulatetimeout:function(){this.status=0,this.isTimeout=!0,this.responseText=void 0,this.readyStateChange(n.DONE)}}),t.extend(n,{UNSENT:0,OPENED:1,LOADING:3,DONE:4}),t.useFakeXDomainRequest=function(){return t.FakeXDomainRequest.restore=function(n){r.supportsXDR&&(e.XDomainRequest=r.GlobalXDomainRequest),delete t.FakeXDomainRequest.restore,!0!==n&&delete t.FakeXDomainRequest.onCreate},r.supportsXDR&&(e.XDomainRequest=t.FakeXDomainRequest),t.FakeXDomainRequest},t.FakeXDomainRequest=n}function n(e,n,r){var o=e("./core");e("../extend"),e("./event"),e("../log_error"),t(o),r.exports=o}var r={XDomainRequest:e.XDomainRequest};r.GlobalXDomainRequest=e.XDomainRequest,r.supportsXDR=void 0!==r.GlobalXDomainRequest,r.workingXDR=!!r.supportsXDR&&r.GlobalXDomainRequest;var o="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(n):o?n(require,module.exports,module):t(sinon)}("undefined"!=typeof global?global:self),function(e,t){function n(){this.eventListeners={abort:[],error:[],load:[],loadend:[],progress:[]}}function r(){this.readyState=r.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="",this.upload=new n,this.responseType="",this.response="",T.supportsCORS&&(this.withCredentials=!1);for(var e=this,t=["loadstart","load","abort","error","loadend"],o=t.length-1;o>=0;o--)!function(t){e.addEventListener(t,function(n){var r=e["on"+t];r&&"function"==typeof r&&r.call(this,n)})}(t[o]);"function"==typeof r.onCreate&&r.onCreate(this)}function o(e){if(e.readyState!==r.OPENED)throw new Error("INVALID_STATE_ERR");if(e.sendFlag)throw new Error("INVALID_STATE_ERR")}function s(e,t){t=t.toLowerCase();for(var n in e)if(n.toLowerCase()===t)return n;return null}function i(e,t){if(e)for(var n=0,r=e.length;n<r;n+=1)t(e[n])}function a(e,t){for(var n=0;n<e.length;n++)if(!0===t(e[n]))return!0;return!1}function u(e){if(e.readyState!==r.OPENED)throw new Error("INVALID_STATE_ERR - "+e.readyState)}function f(e){if(e.readyState===r.DONE)throw new Error("Request done")}function c(e){if(e.async&&e.readyState!==r.HEADERS_RECEIVED)throw new Error("No headers received")}function d(e){if("string"!=typeof e){var t=new Error("Attempted to respond to fake XMLHttpRequest with "+e+", which is not a string.");throw t.name="InvalidBodyException",t}}function p(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=256)throw new TypeError("arraybuffer or blob responseTypes require binary string, invalid character "+e[r]+" found.");n[r]=o}return t}function l(e){return!e||/(text\/xml)|(application\/xml)|(\+xml)/.test(e)}function h(e,t,n){if(""===e||"text"===e)return n;if(b&&"arraybuffer"===e)return p(n);if("json"===e)try{return JSON.parse(n)}catch(e){return null}else{if(R&&"blob"===e){var o={};return t&&(o.type=t),new Blob([p(n)],o)}if("document"===e)return l(t)?r.parseXML(n):null}throw new Error("Invalid responseType "+e)}function y(e){""===e.responseType||"text"===e.responseType?e.response=e.responseText="":e.response=e.responseText=null,e.responseXML=null}function v(e){e.xhr=T,e.extend(r.prototype,e.EventTarget,{async:!0,open:function(e,t,n,o,s){if(this.method=e,this.url=t,this.async="boolean"!=typeof n||n,this.username=o,this.password=s,y(this),this.requestHeaders={},this.sendFlag=!1,!0===r.useFilters){var i=arguments;if(a(r.filters,function(e){return e.apply(this,i)}))return r.defake(this,arguments)}this.readyStateChange(r.OPENED)},readyStateChange:function(t){this.readyState=t;var n,o,s=new e.Event("readystatechange",!1,!1,this);if("function"==typeof this.onreadystatechange)try{this.onreadystatechange(s)}catch(t){e.logError("Fake XHR onreadystatechange handler",t)}this.readyState===r.DONE&&(o={loaded:this.progress||0,total:this.progress||0},n=0===this.status?this.aborted?"abort":"error":"load",g&&(this.upload.dispatchEvent(new e.ProgressEvent("progress",o,this)),this.upload.dispatchEvent(new e.ProgressEvent(n,o,this)),this.upload.dispatchEvent(new e.ProgressEvent("loadend",o,this))),this.dispatchEvent(new e.ProgressEvent("progress",o,this)),this.dispatchEvent(new e.ProgressEvent(n,o,this)),this.dispatchEvent(new e.ProgressEvent("loadend",o,this))),this.dispatchEvent(s)},setRequestHeader:function(e,t){if(o(this),q[e]||/^(Sec-|Proxy-)/.test(e))throw new Error('Refused to set unsafe header "'+e+'"');this.requestHeaders[e]?this.requestHeaders[e]+=","+t:this.requestHeaders[e]=t},setResponseHeaders:function(e){u(this),this.responseHeaders={};for(var t in e)e.hasOwnProperty(t)&&(this.responseHeaders[t]=e[t]);this.async?this.readyStateChange(r.HEADERS_RECEIVED):this.readyState=r.HEADERS_RECEIVED},send:function(t){if(o(this),!/^(get|head)$/i.test(this.method)){var n=s(this.requestHeaders,"Content-Type");if(this.requestHeaders[n]){var i=this.requestHeaders[n].split(";");this.requestHeaders[n]=i[0]+";charset=utf-8"}else!w||t instanceof FormData||(this.requestHeaders["Content-Type"]="text/plain;charset=utf-8");this.requestBody=t}this.errorFlag=!1,this.sendFlag=this.async,y(this),this.readyStateChange(r.OPENED),"function"==typeof this.onSend&&this.onSend(this),this.dispatchEvent(new e.Event("loadstart",!1,!1,this))},abort:function(){this.aborted=!0,y(this),this.errorFlag=!0,this.requestHeaders={},this.responseHeaders={},this.readyState>r.UNSENT&&this.sendFlag&&(this.readyStateChange(r.DONE),this.sendFlag=!1),this.readyState=r.UNSENT},error:function(){y(this),this.errorFlag=!0,this.requestHeaders={},this.responseHeaders={},this.readyStateChange(r.DONE)},getResponseHeader:function(e){return this.readyState<r.HEADERS_RECEIVED?null:/^Set-Cookie2?$/i.test(e)?null:(e=s(this.responseHeaders,e),this.responseHeaders[e]||null)},getAllResponseHeaders:function(){if(this.readyState<r.HEADERS_RECEIVED)return"";var e="";for(var t in this.responseHeaders)this.responseHeaders.hasOwnProperty(t)&&!/^Set-Cookie2?$/i.test(t)&&(e+=t+": "+this.responseHeaders[t]+"\r\n");return e},setResponseBody:function(e){f(this),c(this),d(e);var t=this.getResponseHeader("Content-Type"),n=""===this.responseType||"text"===this.responseType;if(y(this),this.async){var o=this.chunkSize||10,s=0;do{this.readyStateChange(r.LOADING),n&&(this.responseText=this.response+=e.substring(s,s+o)),s+=o}while(s<e.length)}this.response=h(this.responseType,t,e),n&&(this.responseText=this.response),"document"===this.responseType?this.responseXML=this.response:""===this.responseType&&l(t)&&(this.responseXML=r.parseXML(this.responseText)),this.progress=e.length,this.readyStateChange(r.DONE)},respond:function(e,t,n){this.status="number"==typeof e?e:200,this.statusText=r.statusCodes[this.status],this.setResponseHeaders(t||{}),this.setResponseBody(n||"")},uploadProgress:function(t){g&&this.upload.dispatchEvent(new e.ProgressEvent("progress",t))},downloadProgress:function(t){g&&this.dispatchEvent(new e.ProgressEvent("progress",t))},uploadError:function(t){E&&this.upload.dispatchEvent(new e.CustomEvent("error",{detail:t}))}}),e.extend(r,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),e.useFakeXMLHttpRequest=function(){return r.restore=function(e){T.supportsXHR&&(t.XMLHttpRequest=T.GlobalXMLHttpRequest),T.supportsActiveX&&(t.ActiveXObject=T.GlobalActiveXObject),delete r.restore,!0!==e&&delete r.onCreate},T.supportsXHR&&(t.XMLHttpRequest=r),T.supportsActiveX&&(t.ActiveXObject=function(e){return"Microsoft.XMLHTTP"===e||/^Msxml2\.XMLHTTP/i.test(e)?new r:new T.GlobalActiveXObject(e)}),r},e.FakeXMLHttpRequest=r}function m(e,t,n){var r=e("./core");e("../extend"),e("./event"),e("../log_error"),v(r),n.exports=r}var g="undefined"!=typeof ProgressEvent,E="undefined"!=typeof CustomEvent,w="undefined"!=typeof FormData,b="undefined"!=typeof ArrayBuffer,R=function(){try{return!!new Blob}catch(e){return!1}}(),T={XMLHttpRequest:t.XMLHttpRequest};T.GlobalXMLHttpRequest=t.XMLHttpRequest,T.GlobalActiveXObject=t.ActiveXObject,T.supportsActiveX=void 0!==T.GlobalActiveXObject,T.supportsXHR=void 0!==T.GlobalXMLHttpRequest,T.workingXHR=function(e){return void 0!==e.XMLHttpRequest?e.XMLHttpRequest:!(void 0===e.ActiveXObject)&&function(){return new e.ActiveXObject("MSXML2.XMLHTTP.3.0")}}(t),T.supportsCORS=T.supportsXHR&&"withCredentials"in new T.GlobalXMLHttpRequest;var q={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};n.prototype.addEventListener=function(e,t){this.eventListeners[e].push(t)},n.prototype.removeEventListener=function(e,t){for(var n=this.eventListeners[e]||[],r=0,o=n.length;r<o;++r)if(n[r]===t)return n.splice(r,1)},n.prototype.dispatchEvent=function(e){for(var t,n=this.eventListeners[e.type]||[],r=0;null!=(t=n[r]);r++)t(e)};var S=function(e,t,n){switch(n.length){case 0:return e[t]();case 1:return e[t](n[0]);case 2:return e[t](n[0],n[1]);case 3:return e[t](n[0],n[1],n[2]);case 4:return e[t](n[0],n[1],n[2],n[3]);case 5:return e[t](n[0],n[1],n[2],n[3],n[4])}};r.filters=[],r.addFilter=function(e){this.filters.push(e)};var x=/MSIE 6/;r.defake=function(e,t){var n=new T.workingXHR;i(["open","setRequestHeader","send","abort","getResponseHeader","getAllResponseHeaders","addEventListener","overrideMimeType","removeEventListener"],function(t){e[t]=function(){return S(n,t,arguments)}});var o=function(t){i(t,function(t){try{e[t]=n[t]}catch(e){if(!x.test(navigator.userAgent))throw e}})},s=function(){e.readyState=n.readyState,n.readyState>=r.HEADERS_RECEIVED&&o(["status","statusText"]),n.readyState>=r.LOADING&&o(["responseText","response"]),n.readyState===r.DONE&&o(["responseXML"]),e.onreadystatechange&&e.onreadystatechange.call(e,{target:e})};if(n.addEventListener){for(var a in e.eventListeners)e.eventListeners.hasOwnProperty(a)&&i(e.eventListeners[a],function(e){n.addEventListener(a,e)});n.addEventListener("readystatechange",s)}else n.onreadystatechange=s;S(n,"open",t)},r.useFilters=!1,r.parseXML=function(e){if(""!==e)try{if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(e,"text/xml");var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}catch(e){}return null},r.statusCodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};var k="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(m):k?m(require,module.exports,module):e&&v(e)}("object"==typeof sinon&&sinon,"undefined"!=typeof global?global:self),function(e,t){function n(e){function n(e){return""+e}var r,o="undefined"!=typeof module&&module.exports&&"function"==typeof require;if(o)try{t=require("formatio")}catch(e){}return r=t?function(){var e=t.configure({quoteStrings:!1,limitChildrenCount:250});return function(){return e.ascii.apply(e,arguments)}}():o?function(){try{var e=require("util")}catch(e){}return e?function(t){return"object"==typeof t&&t.toString===Object.prototype.toString?e.inspect(t):t}:n}():n,e.format=r,e.format}function r(e,t,r){var o=e("./util/core");r.exports=n(o)}var o="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(r):o?r(require,module.exports,module):e&&n(e)}("object"==typeof sinon&&sinon,"object"==typeof formatio&&formatio),function(){function e(e){var t=e;if("[object Array]"!==Object.prototype.toString.call(e)&&(t=[200,{},e]),"string"!=typeof t[2])throw new TypeError("Fake server response body should be string, but was "+typeof t[2]);return t}function t(e,t,n){var r=e.method,o=!r||r.toLowerCase()===t.toLowerCase(),s=e.url,i=!s||s===n||"function"==typeof s.test&&s.test(n);return o&&i}function n(e,n){var r=n.url;if(/^https?:\/\//.test(r)&&!a.test(r)||(r=r.replace(a,"")),t(e,this.getHTTPMethod(n),r)){if("function"==typeof e.response){var o=e.url,s=[n].concat(o&&"function"==typeof o.exec?o.exec(r).slice(1):[]);return e.response.apply(e,s)}return!0}return!1}function r(t){t.fakeServer={create:function(e){var n=t.create(this);return n.configure(e),t.xhr.supportsCORS?this.xhr=t.useFakeXMLHttpRequest():this.xhr=t.useFakeXDomainRequest(),n.requests=[],this.xhr.onCreate=function(e){n.addRequest(e)},n},configure:function(e){var t,n={autoRespond:!0,autoRespondAfter:!0,respondImmediately:!0,fakeHTTPMethods:!0};e=e||{};for(t in e)n.hasOwnProperty(t)&&e.hasOwnProperty(t)&&(this[t]=e[t])},addRequest:function(e){var t=this;s.call(this.requests,e),e.onSend=function(){t.handleRequest(this),t.respondImmediately?t.respond():t.autoRespond&&!t.responding&&(setTimeout(function(){t.responding=!1,t.respond()},t.autoRespondAfter||10),t.responding=!0)}},getHTTPMethod:function(e){if(this.fakeHTTPMethods&&/post/i.test(e.method)){var t=(e.requestBody||"").match(/_method=([^\b;]+)/);return t?t[1]:e.method}return e.method},handleRequest:function(e){e.async?(this.queue||(this.queue=[]),s.call(this.queue,e)):this.processRequest(e)},log:function(e,n){var r;r="Request:\n"+t.format(n)+"\n\n",r+="Response:\n"+t.format(e)+"\n\n",t.log(r)},respondWith:function(t,n,r){1!==arguments.length||"function"==typeof t?(this.responses||(this.responses=[]),1===arguments.length&&(r=t,n=t=null),2===arguments.length&&(r=n,n=t,t=null),s.call(this.responses,{method:t,url:n,response:"function"==typeof r?r:e(r)})):this.response=e(t)},respond:function(){arguments.length>0&&this.respondWith.apply(this,arguments);for(var e=this.queue||[],t=e.splice(0,e.length),n=0;n<t.length;n++)this.processRequest(t[n])},processRequest:function(e){try{if(e.aborted)return;var r=this.response||[404,{},""];if(this.responses)for(var o=this.responses.length-1;o>=0;o--)if(n.call(this,this.responses[o],e)){r=this.responses[o].response;break}4!==e.readyState&&(this.log(r,e),e.respond(r[0],r[1],r[2]))}catch(e){t.logError("Fake server request processing",e)}},restore:function(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}}function o(e,t,n){var o=e("./core");e("./fake_xdomain_request"),e("./fake_xml_http_request"),e("../format"),r(o),n.exports=o}var s=[].push,i="undefined"!=typeof window?window.location:{},a=new RegExp("^"+i.protocol+"//"+i.host),u="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(o):u?o(require,module.exports,module):r(sinon)}(),function(){function e(e,t){var n="undefined"!=typeof lolex?lolex:t;e.useFakeTimers=function(){var e,t=Array.prototype.slice.call(arguments);e="string"==typeof t[0]?0:t.shift();var r=n.install(e||0,t);return r.restore=r.uninstall,r},e.clock={create:function(e){return n.createClock(e)}},e.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:"undefined"!=typeof setImmediate?setImmediate:void 0,clearImmediate:"undefined"!=typeof clearImmediate?clearImmediate:void 0,setInterval:setInterval,clearInterval:clearInterval,Date:Date}}function t(t,n,r,o){var s=t("./core");e(s,o),r.exports=s}var n="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(t):n?t(require,module.exports,module,require("lolex")):e(sinon)}(),function(){function e(e){function t(){}t.prototype=e.fakeServer,e.fakeServerWithClock=new t,e.fakeServerWithClock.addRequest=function(t){if(t.async&&("object"==typeof setTimeout.clock?this.clock=setTimeout.clock:(this.clock=e.useFakeTimers(),this.resetClock=!0),!this.longestTimeout)){var n=this.clock.setTimeout,r=this.clock.setInterval,o=this;this.clock.setTimeout=function(e,t){return o.longestTimeout=Math.max(t,o.longestTimeout||0),n.apply(this,arguments)},this.clock.setInterval=function(e,t){return o.longestTimeout=Math.max(t,o.longestTimeout||0),r.apply(this,arguments)}}return e.fakeServer.addRequest.call(this,t)},e.fakeServerWithClock.respond=function(){var t=e.fakeServer.respond.apply(this,arguments);return this.clock&&(this.clock.tick(this.longestTimeout||0),this.longestTimeout=0,this.resetClock&&(this.clock.restore(),this.resetClock=!1)),t},e.fakeServerWithClock.restore=function(){return this.clock&&this.clock.restore(),e.fakeServer.restore.apply(this,arguments)}}function t(t){var n=t("./core");t("./fake_server"),t("./fake_timers"),e(n)}var n="undefined"!=typeof module&&module.exports&&"function"==typeof require;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(t):n?t(require):e(sinon)}();