!function(){function t(t){var e="";for(t=Math.floor(t);0!==t;)e="0123456789ABCDEF"[t%16]+e,t=Math.floor(t/16);for(;e.length<2;)e="0"+e;return e}function e(e){function n(e){return t(256*e)}return e<0?"#FF0000":e<1/3?"#FF"+n(3*e)+"00":e<2/3?"#"+n(2-3*e)+"FF00":e<1?"#00FF"+n(3*e-2):"#00FFFF"}function n(t){return 20!==t.length?new Date:new Date(t)}L.GPX.include({options:{maxSpeed:110,chunks:200},speedSplitEnable:function(t){return L.Util.setOptions(this,t),this.on("addline",this.speed_split,this)},speedSplitDisable:function(){return this.off("addline",this.speed_split,this)},speed_split:function(t){var i=t.line.pop().getLatLngs(),o=Math.floor(i.length/this.options.chunks);o<3&&(o=3);for(var l=null,s=0;s<i.length;s+=o){var r=0,h=null;s+o>i.length&&(o=i.length-s);for(var p=0;p<o;p++)l&&(r+=l.distanceTo(i[s+p])),l=i[s+p],h||(h=n(l.meta.time));var a=.001*r/(h=(n((l=i[s+o-1]).meta.time)-h)/36e5),u=e(a/this.options.maxSpeed),d=new L.Polyline(i.slice(s,s+o+1),{color:u,weight:2,opacity:1});d.bindPopup("Dist: "+r.toFixed()+"m; Speed: "+a.toFixed(2)+" km/h"),t.line.push(d)}}})}();