!function(t,e){function n(e,c,o){function s(e,n,a){l(e,n),t(this).each(function(){t(this).html(e.html())}),"function"==typeof a&&a.call(t(this))}function l(e,n){function a(n,a,i,c){t("["+n+"]",e).each(function(e,o){var s=t(o).attr(n);t(o).removeAttr(n);var l=r(a,s);l&&i?i(t(o),l):c&&c(t(o))})}function r(t,e){for(var n,a=e.split("."),r=t;(n=a.shift())&&r;)r=r[n];return r}function c(t,e,n){var a=t.attr("data-format-target");if(a==n||!a&&"content"==n){var r=t.attr("data-format");if(r&&"function"==typeof i[r]){var c=t.attr("data-format-template");return i[r](e,c)}}return e}a("data-content",n=n||{},function(t,e){t.html(c(t,e,"content"))}),a("data-src",n,function(t,e){t.attr("src",c(t,e,"src"))},function(t){t.remove()}),a("data-alt",n,function(t,e){t.attr("alt",c(t,e,"alt"))}),a("data-link",n,function(e,n){var a=t("<a/>");a.attr("href",c(e,n,"link")),a.html(e.html()),e.html(a)}),a("data-link-wrap",n,function(e,n){var a=t("<a/>");a.attr("href",c(e,n,"link-wrap")),e.wrap(a)}),function(n){t("[data-template-bind]",e).each(function(e,a){var c=t.parseJSON(t(a).attr("data-template-bind"));t(a).removeAttr("data-template-bind"),t(c).each(function(){var e=r(n,this.value);e&&this.attribute&&(this.formatter&&i[this.formatter]&&(e=i[this.formatter](e,this.formatTemplate)),"content"===this.attribute?t(a).html(e):t(a).attr(this.attribute,e))})})}(n)}var f=this;if("array"===t.type(c)){this.html("");var u=c.length,h=0;o=o||{};var m=t.extend({},o,{complete:function(){f.append(this.html()),++h==u&&o&&"function"==typeof o.complete&&o.complete()}});return t(c).each(function(){var a=t("<div/>");n.call(a,e,this,m)}),this}var p=t.extend({overwriteCache:!1,complete:null,success:null,error:function(){t(this).each(function(){t(this).html(p.errorMessage)})},errorMessage:"There was an error loading the template."},o);if(!function(t){return"string"==typeof t&&t.indexOf("/")>-1}(e))var d=t(e);var v=p.isFile||void 0===p.isFile&&(!d||0==d.length);if(v&&!p.overwriteCache&&a[e])g=a[e].clone(),s.call(f,g,c,p.complete),"function"==typeof p.success&&p.success();else if(v&&!p.overwriteCache&&a.hasOwnProperty(e))r[e]?r[e].push({data:c,selection:f,settings:p}):r[e]=[{data:c,selection:f,settings:p}];else if(v){g=t("<div/>");a[e]=null,g.load(e,function(n,i,o){if("error"==i){if("function"==typeof p.error&&p.error.call(f),t(r[e]).each(function(t,e){"function"==typeof e.settings.error&&e.settings.error.call(e.selection)}),"function"==typeof p.complete){p.complete.call(f)}for(;l=r[e].shift();)"function"==typeof l.settings.complete&&l.settings.complete.call(l.selection);r[e].length>0&&(r[e]=[])}else{a[e]=g.clone(),s.call(f,g,c,p.complete),"success"==i&&"function"==typeof p.success&&p.success.call(f);for(var l;l=r[e].shift();)s.call(l.selection,a[e].clone(),l.data,l.settings.complete),"success"==i&&"function"==typeof l.settings.success&&l.settings.success.call(l.selection)}})}else{var g=t("<div/>");d.is("script")&&(d=t.parseHTML(t.trim(d.html()))),g.html(d),s.call(f,g,c,p.complete),"function"==typeof p.success&&p.success()}return this}var a={},r={},i={getFormattedDateString:function(t,e){return e=e||"MMMM yyyy",new Date(t).toLocaleDateString(e)}};t.fn.loadTemplate=n,t.addTemplateFormatter=function(e,n){n?i[e]=n:i=t.extend(i,e)}}(jQuery);