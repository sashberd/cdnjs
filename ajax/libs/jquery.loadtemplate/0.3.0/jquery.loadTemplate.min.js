!function(t,e){function n(e,i,o){function s(e,n,a){l(e,n),t(this).each(function(){t(this).html(e.html())}),"function"==typeof a&&a.call(t(this))}function l(e,n){function a(n,a,r,c){t("["+n+"]",e).each(function(e,i){var o=t(i).attr(n);t(i).removeAttr(n),a[o]&&r?r(t(i),a[o]):c&&c(t(i))})}function r(t,e,n){var a=t.attr("data-format-target");if(a==n||!a&&"content"==n){var r=t.attr("data-format");if(r&&"function"==typeof c[r]){var i=t.attr("data-format-template");return c[r](e,i)}}return e}a("data-content",n=n||{},function(t,e){t.html(r(t,e,"content"))}),a("data-src",n,function(t,e){t.attr("src",r(t,e,"src"))},function(t){t.remove()}),a("data-alt",n,function(t,e){t.attr("alt",r(t,e,"alt"))}),a("data-link",n,function(e,n){var a=t("<a/>");a.attr("href",r(e,n,"link")),a.html(e.html()),e.html(a)}),a("data-link-wrap",n,function(e,n){var a=t("<a/>");a.attr("href",r(e,n,"link-wrap")),e.wrap(a)}),function(n){t("[data-template-bind]",e).each(function(e,a){var r=t.parseJSON(t(a).attr("data-template-bind"));t(a).removeAttr("data-template-bind"),t(r).each(function(){var e=n[this.value];e&&this.attribute&&(this.formatter&&c[this.formatter]&&(e=c[this.formatter](e,this.formatTemplate)),"content"===this.attribute?t(a).html(e):t(a).attr(this.attribute,e))})})}(n)}var f=this;if("array"===t.type(i)){var u=i.length,h=0;o=o||{};var m=t.extend({},o,{complete:function(){f.append(this),++h==u&&o&&"function"==typeof o.complete&&o.complete()}});return t(i).each(function(){var a=t("<div/>");n.call(a,e,this,m)}),this}var p=t.extend({overwriteCache:!1,complete:null,success:null,error:function(){t(this).each(function(){t(this).html(p.errorMessage)})},errorMessage:"There was an error loading the template."},o);if(!function(t){return"string"==typeof t&&t.indexOf("/")>-1}(e))var d=t(e);var v=p.isFile||void 0===p.isFile&&(!d||0==d.length);if(v&&!p.overwriteCache&&a[e])g=a[e],s.call(f,g,i,p.complete),"function"==typeof p.success&&p.success();else if(v&&!p.overwriteCache&&a.hasOwnProperty(e))r[e]?r[e].push({data:i,selection:f,settings:p}):r[e]=[{data:i,selection:f,settings:p}];else if(v){g=t("<div/>");a[e]=null,g.load(e,function(n,c,o){if("error"==c){if("function"==typeof p.error&&p.error.call(f),t(r[e]).each(function(t,e){"function"==typeof e.settings.error&&e.settings.error.call(e.selection)}),"function"==typeof p.complete){p.complete.call(f)}for(;l=r[e].shift();)"function"==typeof l.settings.complete&&l.settings.complete.call(l.selection);r[e].length>0&&(r[e]=[])}else{a[e]=g.clone(),s.call(f,g,i,p.complete),"success"==c&&"function"==typeof p.success&&p.success.call(f);for(var l;l=r[e].shift();)s.call(l.selection,a[e].clone(),l.data,l.settings.complete),"success"==c&&"function"==typeof l.settings.success&&l.settings.success.call(l.selection)}})}else{var g=t("<div/>");d.is("script")&&(d=t.parseHTML(t.trim(d.html()))),g.html(d),s.call(f,g,i,p.complete),"function"==typeof p.success&&p.success()}return this}var a={},r={},c={getFormattedDateString:function(t,e){return e=e||"MMMM yyyy",new Date(t).toLocaleDateString(e)}};t.fn.loadTemplate=n,t.addTemplateFormatter=function(e,n){n?c[e]=n:c=t.extend(c,e)}}(jQuery);