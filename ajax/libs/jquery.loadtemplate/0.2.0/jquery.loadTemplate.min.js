!function(t,e){var n={},r={},a={getFormattedDateString:function(t,e){return e=e||"MMMM yyyy",new Date(t).toLocaleDateString(e)}};t.fn.loadTemplate=function(e,c,o){function i(e,n){l(e,n),t(this).each(function(){t(this).html(e.html())}),"function"==typeof f.complete&&f.complete()}function l(e,n){function r(n,r,a,c){t("["+n+"]",e).each(function(e,o){var i=t(o).attr(n);t(o).removeAttr(n),r[i]&&a?a(t(o),r[i]):c&&c(t(o))})}function c(t,e,n){var r=t.attr("data-format-target");if(r==n||!r&&"content"==n){var c=t.attr("data-format");if(c&&"function"==typeof a[c]){var o=t.attr("data-format-template");return a[c](e,o)}}return e}r("data-content",n=n||{},function(t,e){t.html(c(t,e,"content"))}),r("data-src",n,function(t,e){t.attr("src",c(t,e,"src"))},function(t){t.remove()}),r("data-alt",n,function(t,e){t.attr("alt",c(t,e,"alt"))}),r("data-link",n,function(e,n){var r=t("<a/>");r.attr("href",c(e,n,"link")),r.html(e.html()),e.html(r)}),r("data-link-wrap",n,function(e,n){var r=t("<a/>");r.attr("href",c(e,n,"link-wrap")),e.wrap(r)})}var s=this,f=t.extend({overwriteCache:!1,complete:null,success:null,error:function(){t(this).each(function(){t(this).html(f.errorMessage)})},errorMessage:"There was an error loading the template."},o);if(!function(t){return"string"==typeof t&&t.indexOf("/")>-1}(e))var u=t(e);var h=f.isFile||void 0===f.isFile&&(!u||0==u.length);if(h&&!f.overwriteCache&&n[e])p=n[e],i.call(s,p,c),"function"==typeof f.success&&f.success();else if(h&&!f.overwriteCache&&n.hasOwnProperty(e))r[e]?r[e].push(c):r[e]=[{data:c,selection:s}];else if(h)p=t("<div/>"),n[e]=null,p.load(e,function(a,o,l){if("error"==o){if("function"==typeof f.error&&(f.error.call(s),t(r[e]).each(function(t,e){f.error.call(e.selection)})),"function"==typeof f.complete)for(f.complete.call(s);u=r[e].pop();)f.complete.call(u.selection);r[e].length>0&&(r[e]=[])}else{n[e]=p,i.call(s,p,c),"success"==o&&"function"==typeof f.success&&f.success.call(s);for(var u;u=r[e].pop();)i.call(u.selection,p,u.data),"success"==o&&"function"==typeof f.success&&f.success.call(u.selection)}});else{var p=t("<div/>");u.is("script")&&(u=t.parseHTML(t.trim(u.html()))),p.html(u),i.call(s,p,c),"function"==typeof f.success&&f.success()}return this},t.addTemplateFormatter=function(e,n){n?a[e]=n:a=t.extend(a,e)}}(jQuery);