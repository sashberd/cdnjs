!function(t,e){function n(e,n,l){var f=this,u=t.extend({overwriteCache:!1,complete:null,success:null,error:function(){t(this).each(function(){t(this).html(u.errorMessage)})},errorMessage:"There was an error loading the template.",paged:!1,pageNo:1,elemPerPage:10},l);if("array"===t.type(n))return i.call(this,e,n,u);if(!a(e))var h=t(e);var p=u.isFile||void 0===u.isFile&&(!h||0==h.length);return p&&!u.overwriteCache&&g[e]?o(e,f,n,u):p&&!u.overwriteCache&&g.hasOwnProperty(e)?r(e,f,n,u):p?c(e,f,n,u):s(h,f,n,u),this}function a(t){return"string"==typeof t&&t.indexOf("/")>-1}function i(e,a,i){var r=this;r.html("");var o=a.length,c=0;if((i=i||{}).paged){var s=(i.pageNo-1)*i.elemPerPage;a=a.slice(s,s+i.elemPerPage)}var l=t.extend({},i,{complete:function(){r.append(this.html()),++c==o&&i&&"function"==typeof i.complete&&i.complete()}});return t(a).each(function(){var a=t("<div/>");n.call(a,e,this,l)}),this}function r(t,e,n,a){y[t]?y[t].push({data:n,selection:e,settings:a}):y[t]=[{data:n,selection:e,settings:a}]}function o(t,e,n,a){$templateContainer=g[t].clone(),l.call(e,$templateContainer,n,a.complete),"function"==typeof a.success&&a.success()}function c(e,n,a,i){var r=t("<div/>");g[e]=null,r.load(e,function(t,o,c){"error"==o?f(e,n,a,i):u(r,e,n,a,i)})}function s(e,n,a,i){var r=t("<div/>");e.is("script")&&(e=t.parseHTML(t.trim(e.html()))),r.html(e),l.call(n,r,a,i.complete),"function"==typeof i.success&&i.success()}function l(e,n,a){h(e,n),t(this).each(function(){t(this).html(e.html())}),"function"==typeof a&&a.call(t(this))}function f(e,n,a,i){if("function"==typeof i.error&&i.error.call(n),t(y[e]).each(function(t,e){"function"==typeof e.settings.error&&e.settings.error.call(e.selection)}),"function"==typeof i.complete){i.complete.call($that);var r}for(;y[e]&&(r=y[e].shift());)"function"==typeof r.settings.complete&&r.settings.complete.call(r.selection);y[e].length>0&&(y[e]=[])}function u(t,e,n,a,i){g[e]=t.clone(),l.call(n,t,a,i.complete),"function"==typeof i.success&&i.success.call($that);for(var r;y[e]&&(r=y[e].shift());)l.call(r.selection,g[e].clone(),r.data,r.settings.complete),"function"==typeof r.settings.success&&r.settings.success.call(r.selection)}function h(e,n){p("data-content",e,n=n||{},function(t,e){t.html(d(t,e,"content"))}),p("data-src",e,n,function(t,e){t.attr("src",d(t,e,"src"))},function(t){t.remove()}),p("data-alt",e,n,function(t,e){t.attr("alt",d(t,e,"alt"))}),p("data-link",e,n,function(e,n){var a=t("<a/>");a.attr("href",d(e,n,"link")),a.html(e.html()),e.html(a)}),p("data-link-wrap",e,n,function(e,n){var a=t("<a/>");a.attr("href",d(e,n,"link-wrap")),e.wrap(a)}),m(e,n)}function p(e,n,a,i,r){t("["+e+"]",n).each(function(){$this=t(this);var n=$this.attr(e);$this.removeAttr(e);var o=v(a,n);o&&i?i($this,o):r&&r($this)})}function m(e,n){t("[data-template-bind]",e).each(function(){$this=t(this);var e=t.parseJSON($this.attr("data-template-bind"));$this.removeAttr("data-template-bind"),t(e).each(function(){var t=v(n,this.value);t&&this.attribute&&(this.formatter&&$[this.formatter]&&(t=$[this.formatter](t,this.formatTemplate)),"content"===this.attribute?$this.html(t):$this.attr(this.attribute,t))})})}function v(t,e){for(var n,a=e.split("."),i=t;(n=a.shift())&&i;)i=i[n];return i}function d(t,e,n){var a=t.attr("data-format-target");if(a==n||!a&&"content"==n){var i=t.attr("data-format");if(i&&"function"==typeof $[i]){var r=t.attr("data-format-template");return $[i](e,r)}}return e}var g={},y={},$={};t.fn.loadTemplate=n,t.addTemplateFormatter=function(e,n){n?$[e]=n:$=t.extend($,e)}}(jQuery);