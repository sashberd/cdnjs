!function(t){"use strict";function e(e,s,l){var f,u,p,h=this;return s=s||{},u=t.extend({overwriteCache:!1,complete:null,success:null,error:function(){t(this).each(function(){t(this).html(u.errorMessage)})},errorMessage:"There was an error loading the template.",paged:!1,pageNo:1,elemPerPage:10},l),"array"===t.type(s)?a.call(this,e,s,u):(n(e)||(f=t(e)),(p=u.isFile||void 0===u.isFile&&(void 0===f||0===f.length))&&!u.overwriteCache&&g[e]?i(e,h,s,u):p&&!u.overwriteCache&&g.hasOwnProperty(e)?o(e,h,s,u):p?c(e,h,s,u):r(f,h,s,u),this)}function n(t){return"string"==typeof t&&t.indexOf("/")>-1}function a(n,a,o){var i,c=this,r=a.length,s=0;if((o=o||{}).paged){var l=(o.pageNo-1)*o.elemPerPage;a=a.slice(l,l+o.elemPerPage)}return i=t.extend({},o,{complete:function(){c.append(this.html()),++s===r&&o&&"function"==typeof o.complete&&o.complete()}}),c.html(""),t(a).each(function(){var a=t("<div/>");e.call(a,n,this,i)}),this}function o(t,e,n,a){y[t]?y[t].push({data:n,selection:e,settings:a}):y[t]=[{data:n,selection:e,settings:a}]}function i(t,e,n,a){var o=g[t].clone();s.call(e,o,n,a.complete),"function"==typeof a.success&&a.success()}function c(e,n,a,o){var i=t("<div/>");g[e]=null,i.load(e,function(t,c){"error"===c?l(e,n,a,o):f(i,e,n,a,o)})}function r(e,n,a,o){var i=t("<div/>");e.is("script")&&(e=t.parseHTML(t.trim(e.html()))),i.html(e),s.call(n,i,a,o.complete),"function"==typeof o.success&&o.success()}function s(e,n,a){u(e,n),t(this).each(function(){t(this).html(e.html())}),"function"==typeof a&&a.call(t(this))}function l(e,n,a,o){var i;for("function"==typeof o.error&&o.error.call(n),t(y[e]).each(function(t,e){"function"==typeof e.settings.error&&e.settings.error.call(e.selection)}),"function"==typeof o.complete&&o.complete.call(n);y[e]&&(i=y[e].shift());)"function"==typeof i.settings.complete&&i.settings.complete.call(i.selection);y[e].length>0&&(y[e]=[])}function f(t,e,n,a,o){var i;for(g[e]=t.clone(),s.call(n,t,a,o.complete),"function"==typeof o.success&&o.success.call(n);y[e]&&(i=y[e].shift());)s.call(i.selection,g[e].clone(),i.data,i.settings.complete),"function"==typeof i.settings.success&&i.settings.success.call(i.selection)}function u(e,n){p("data-content",e,n=n||{},function(t,e){t.html(v(t,e,"content"))}),p("data-content-append",e,n,function(t,e){t.append(v(t,e,"content"))}),p("data-content-prepend",e,n,function(t,e){t.prepend(v(t,e,"content"))}),p("data-src",e,n,function(t,e){t.attr("src",v(t,e,"src"))},function(t){t.remove()}),p("data-alt",e,n,function(t,e){t.attr("alt",v(t,e,"alt"))}),p("data-link",e,n,function(e,n){var a=t("<a/>");a.attr("href",v(e,n,"link")),a.html(e.html()),e.html(a)}),p("data-link-wrap",e,n,function(e,n){var a=t("<a/>");a.attr("href",v(e,n,"link-wrap")),e.wrap(a)}),p("data-options",e,n,function(e,n){t(n).each(function(){t("<option/>").attr("value",this).text(this).appendTo(e)})}),h(e,n)}function p(e,n,a,o,i){t("["+e+"]",n).each(function(){var n=t(this),c=n.attr(e),r=m(a,c);n.removeAttr(e),r&&o?o(n,r):i&&i(n)})}function h(e,n){t("[data-template-bind]",e).each(function(){var e=t(this),a=t.parseJSON(e.attr("data-template-bind"));e.removeAttr("data-template-bind"),t(a).each(function(){var a;if(void 0!==(a="object"==typeof this.value?m(n,this.value.data):m(n,this.value))&&this.attribute)switch(this.attribute){case"content":e.html(d(a,this));break;case"contentAppend":e.append(d(a,this));break;case"contentPrepend":e.prepend(d(a,this));break;case"options":var o=this;t(a).each(function(){t("<option/>").attr("value",this[o.value.value]).text(d(this[o.value.content],o)).appendTo(e)});break;default:e.attr(this.attribute,d(a,this))}})})}function d(t,e){return e.formatter&&b[e.formatter]?b[e.formatter](t,e.formatOptions):t}function m(t,e){for(var n,a=e.split("."),o=t;(n=a.shift())&&void 0!==o;)o=o[n];return o}function v(t,e,n){var a,o=t.attr("data-format-target");if((o===n||!o&&"content"===n)&&(a=t.attr("data-format"))&&"function"==typeof b[a]){var i=t.attr("data-format-options");return b[a](e,i)}return e}var g={},y={},b={};t.fn.loadTemplate=e,t.addTemplateFormatter=function(e,n){n?b[e]=n:b=t.extend(b,e)}}(jQuery);